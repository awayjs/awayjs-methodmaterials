var __extends = this.__extends || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    __.prototype = b.prototype;
    d.prototype = new __();
};
var BlendMode = require("awayjs-core/lib/base/BlendMode");
var StaticLightPicker = require("awayjs-display/lib/materials/lightpickers/StaticLightPicker");
var ContextGLCompareMode = require("awayjs-stagegl/lib/base/ContextGLCompareMode");
var RenderObjectBase = require("awayjs-renderergl/lib/compilation/RenderObjectBase");
var MethodPassMode = require("awayjs-methodmaterials/lib/passes/MethodPassMode");
var MethodPass = require("awayjs-methodmaterials/lib/passes/MethodPass");
var MethodMaterialMode = require("awayjs-methodmaterials/lib/MethodMaterialMode");
/**
 * CompiledPass forms an abstract base class for the default compiled pass materials provided by Away3D,
 * using material methods to define their appearance.
 */
var RenderMethodMaterialObject = (function (_super) {
    __extends(RenderMethodMaterialObject, _super);
    /**
     * Creates a new CompiledPass object.
     *
     * @param material The material to which this pass belongs.
     */
    function RenderMethodMaterialObject(pool, material, renderableClass, stage) {
        _super.call(this, pool, material, renderableClass, stage);
        this._material = material;
    }
    Object.defineProperty(RenderMethodMaterialObject.prototype, "numLights", {
        /**
         * The maximum total number of lights provided by the light picker.
         */
        get: function () {
            return this._material.lightPicker ? this._material.lightPicker.numLightProbes + this._material.lightPicker.numDirectionalLights + this._material.lightPicker.numPointLights + this._material.lightPicker.numCastingDirectionalLights + this._material.lightPicker.numCastingPointLights : 0;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RenderMethodMaterialObject.prototype, "numNonCasters", {
        /**
         * The amount of lights that don't cast shadows.
         */
        get: function () {
            return this._material.lightPicker ? this._material.lightPicker.numLightProbes + this._material.lightPicker.numDirectionalLights + this._material.lightPicker.numPointLights : 0;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @inheritDoc
     */
    RenderMethodMaterialObject.prototype._pUpdateRenderObject = function () {
        _super.prototype._pUpdateRenderObject.call(this);
        this.initPasses();
        this.setBlendAndCompareModes();
        this._pClearScreenPasses();
        if (this._material.mode == MethodMaterialMode.MULTI_PASS) {
            if (this._casterLightPass)
                this._pAddScreenPass(this._casterLightPass);
            if (this._nonCasterLightPasses)
                for (var i = 0; i < this._nonCasterLightPasses.length; ++i)
                    this._pAddScreenPass(this._nonCasterLightPasses[i]);
        }
        if (this._screenPass)
            this._pAddScreenPass(this._screenPass);
    };
    /**
     * Initializes all the passes and their dependent passes.
     */
    RenderMethodMaterialObject.prototype.initPasses = function () {
        // let the effects pass handle everything if there are no lights, when there are effect methods applied
        // after shading, or when the material mode is single pass.
        if (this.numLights == 0 || this._material.numEffectMethods > 0 || this._material.mode == MethodMaterialMode.SINGLE_PASS)
            this.initEffectPass();
        else if (this._screenPass)
            this.removeEffectPass();
        // only use a caster light pass if shadows need to be rendered
        if (this._material.shadowMethod && this._material.mode == MethodMaterialMode.MULTI_PASS)
            this.initCasterLightPass();
        else if (this._casterLightPass)
            this.removeCasterLightPass();
        // only use non caster light passes if there are lights that don't cast
        if (this.numNonCasters > 0 && this._material.mode == MethodMaterialMode.MULTI_PASS)
            this.initNonCasterLightPasses();
        else if (this._nonCasterLightPasses)
            this.removeNonCasterLightPasses();
    };
    /**
     * Sets up the various blending modes for all screen passes, based on whether or not there are previous passes.
     */
    RenderMethodMaterialObject.prototype.setBlendAndCompareModes = function () {
        var forceSeparateMVP = Boolean(this._casterLightPass || this._screenPass);
        // caster light pass is always first if it exists, hence it uses normal blending
        if (this._casterLightPass) {
            this._casterLightPass.forceSeparateMVP = forceSeparateMVP;
            this._casterLightPass.setBlendMode(BlendMode.NORMAL);
            this._casterLightPass.depthCompareMode = this._material.depthCompareMode;
        }
        if (this._nonCasterLightPasses) {
            var firstAdditiveIndex = 0;
            // if there's no caster light pass, the first non caster light pass will be the first
            // and should use normal blending
            if (!this._casterLightPass) {
                this._nonCasterLightPasses[0].forceSeparateMVP = forceSeparateMVP;
                this._nonCasterLightPasses[0].setBlendMode(BlendMode.NORMAL);
                this._nonCasterLightPasses[0].depthCompareMode = this._material.depthCompareMode;
                firstAdditiveIndex = 1;
            }
            for (var i = firstAdditiveIndex; i < this._nonCasterLightPasses.length; ++i) {
                this._nonCasterLightPasses[i].forceSeparateMVP = forceSeparateMVP;
                this._nonCasterLightPasses[i].setBlendMode(BlendMode.ADD);
                this._nonCasterLightPasses[i].depthCompareMode = ContextGLCompareMode.LESS_EQUAL;
            }
        }
        if (this._casterLightPass || this._nonCasterLightPasses) {
            //cannot be blended by blendmode property if multipass enabled
            this._pRequiresBlending = false;
            // there are light passes, so this should be blended in
            if (this._screenPass) {
                this._screenPass.mode = MethodPassMode.EFFECTS;
                this._screenPass.depthCompareMode = ContextGLCompareMode.LESS_EQUAL;
                this._screenPass.setBlendMode(BlendMode.LAYER);
                this._screenPass.forceSeparateMVP = forceSeparateMVP;
            }
        }
        else if (this._screenPass) {
            this._pRequiresBlending = (this._material.blendMode != BlendMode.NORMAL || this._material.alphaBlending || (this._material.colorTransform && this._material.colorTransform.alphaMultiplier < 1));
            // effects pass is the only pass, so it should just blend normally
            this._screenPass.mode = MethodPassMode.SUPER_SHADER;
            this._screenPass.depthCompareMode = this._material.depthCompareMode;
            this._screenPass.preserveAlpha = this._pRequiresBlending;
            this._screenPass.colorTransform = this._material.colorTransform;
            this._screenPass.setBlendMode((this._material.blendMode == BlendMode.NORMAL && this._pRequiresBlending) ? BlendMode.LAYER : this._material.blendMode);
            this._screenPass.forceSeparateMVP = false;
        }
    };
    RenderMethodMaterialObject.prototype.initCasterLightPass = function () {
        if (this._casterLightPass == null)
            this._casterLightPass = new MethodPass(MethodPassMode.LIGHTING, this, this._material, this._renderableClass, this._stage);
        this._casterLightPass.lightPicker = new StaticLightPicker([this._material.shadowMethod.castingLight]);
        this._casterLightPass.shadowMethod = this._material.shadowMethod;
        this._casterLightPass.diffuseMethod = this._material.diffuseMethod;
        this._casterLightPass.ambientMethod = this._material.ambientMethod;
        this._casterLightPass.normalMethod = this._material.normalMethod;
        this._casterLightPass.specularMethod = this._material.specularMethod;
    };
    RenderMethodMaterialObject.prototype.removeCasterLightPass = function () {
        this._casterLightPass.dispose();
        this._pRemoveScreenPass(this._casterLightPass);
        this._casterLightPass = null;
    };
    RenderMethodMaterialObject.prototype.initNonCasterLightPasses = function () {
        this.removeNonCasterLightPasses();
        var pass;
        var numDirLights = this._material.lightPicker.numDirectionalLights;
        var numPointLights = this._material.lightPicker.numPointLights;
        var numLightProbes = this._material.lightPicker.numLightProbes;
        var dirLightOffset = 0;
        var pointLightOffset = 0;
        var probeOffset = 0;
        if (!this._casterLightPass) {
            numDirLights += this._material.lightPicker.numCastingDirectionalLights;
            numPointLights += this._material.lightPicker.numCastingPointLights;
        }
        this._nonCasterLightPasses = new Array();
        while (dirLightOffset < numDirLights || pointLightOffset < numPointLights || probeOffset < numLightProbes) {
            pass = new MethodPass(MethodPassMode.LIGHTING, this, this._material, this._renderableClass, this._stage);
            pass.includeCasters = this._material.shadowMethod == null;
            pass.directionalLightsOffset = dirLightOffset;
            pass.pointLightsOffset = pointLightOffset;
            pass.lightProbesOffset = probeOffset;
            pass.lightPicker = this._material.lightPicker;
            pass.diffuseMethod = this._material.diffuseMethod;
            pass.ambientMethod = this._material.ambientMethod;
            pass.normalMethod = this._material.normalMethod;
            pass.specularMethod = this._material.specularMethod;
            this._nonCasterLightPasses.push(pass);
            dirLightOffset += pass.numDirectionalLights;
            pointLightOffset += pass.numPointLights;
            probeOffset += pass.numLightProbes;
        }
    };
    RenderMethodMaterialObject.prototype.removeNonCasterLightPasses = function () {
        if (!this._nonCasterLightPasses)
            return;
        for (var i = 0; i < this._nonCasterLightPasses.length; ++i)
            this._pRemoveScreenPass(this._nonCasterLightPasses[i]);
        this._nonCasterLightPasses = null;
    };
    RenderMethodMaterialObject.prototype.removeEffectPass = function () {
        if (this._screenPass.ambientMethod != this._material.ambientMethod)
            this._screenPass.ambientMethod.dispose();
        if (this._screenPass.diffuseMethod != this._material.diffuseMethod)
            this._screenPass.diffuseMethod.dispose();
        if (this._screenPass.specularMethod != this._material.specularMethod)
            this._screenPass.specularMethod.dispose();
        if (this._screenPass.normalMethod != this._material.normalMethod)
            this._screenPass.normalMethod.dispose();
        this._pRemoveScreenPass(this._screenPass);
        this._screenPass = null;
    };
    RenderMethodMaterialObject.prototype.initEffectPass = function () {
        if (this._screenPass == null)
            this._screenPass = new MethodPass(MethodPassMode.SUPER_SHADER, this, this._material, this._renderableClass, this._stage);
        if (this._material.mode == MethodMaterialMode.SINGLE_PASS) {
            this._screenPass.ambientMethod = this._material.ambientMethod;
            this._screenPass.diffuseMethod = this._material.diffuseMethod;
            this._screenPass.specularMethod = this._material.specularMethod;
            this._screenPass.normalMethod = this._material.normalMethod;
            this._screenPass.shadowMethod = this._material.shadowMethod;
        }
        else if (this._material.mode == MethodMaterialMode.MULTI_PASS) {
            if (this.numLights == 0) {
                this._screenPass.ambientMethod = this._material.ambientMethod;
            }
            else {
                this._screenPass.ambientMethod = null;
            }
            this._screenPass.preserveAlpha = false;
            this._screenPass.normalMethod = this._material.normalMethod;
        }
        //update effect methods
        var i = 0;
        var effectMethod;
        var len = Math.max(this._material.numEffectMethods, this._screenPass.numEffectMethods);
        while (i < len) {
            effectMethod = this._material.getEffectMethodAt(i);
            if (effectMethod != this._screenPass.getEffectMethodAt(i)) {
                this._screenPass.removeEffectMethodAt(i);
                if (effectMethod != null) {
                    if (i < this._screenPass.numEffectMethods)
                        this._screenPass.addEffectMethodAt(effectMethod, i);
                    else
                        this._screenPass.addEffectMethod(effectMethod);
                }
            }
            i++;
        }
    };
    /**
     * @inheritDoc
     */
    RenderMethodMaterialObject.prototype.dispose = function () {
        _super.prototype.dispose.call(this);
        //TODO
    };
    /**
     *
     */
    RenderMethodMaterialObject.id = "method";
    return RenderMethodMaterialObject;
})(RenderObjectBase);
module.exports = RenderMethodMaterialObject;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF3YXlqcy1tZXRob2RtYXRlcmlhbHMvbGliL2NvbXBpbGF0aW9uL1JlbmRlck1ldGhvZE1hdGVyaWFsT2JqZWN0LnRzIl0sIm5hbWVzIjpbIlJlbmRlck1ldGhvZE1hdGVyaWFsT2JqZWN0IiwiUmVuZGVyTWV0aG9kTWF0ZXJpYWxPYmplY3QuY29uc3RydWN0b3IiLCJSZW5kZXJNZXRob2RNYXRlcmlhbE9iamVjdC5udW1MaWdodHMiLCJSZW5kZXJNZXRob2RNYXRlcmlhbE9iamVjdC5udW1Ob25DYXN0ZXJzIiwiUmVuZGVyTWV0aG9kTWF0ZXJpYWxPYmplY3QuX3BVcGRhdGVSZW5kZXJPYmplY3QiLCJSZW5kZXJNZXRob2RNYXRlcmlhbE9iamVjdC5pbml0UGFzc2VzIiwiUmVuZGVyTWV0aG9kTWF0ZXJpYWxPYmplY3Quc2V0QmxlbmRBbmRDb21wYXJlTW9kZXMiLCJSZW5kZXJNZXRob2RNYXRlcmlhbE9iamVjdC5pbml0Q2FzdGVyTGlnaHRQYXNzIiwiUmVuZGVyTWV0aG9kTWF0ZXJpYWxPYmplY3QucmVtb3ZlQ2FzdGVyTGlnaHRQYXNzIiwiUmVuZGVyTWV0aG9kTWF0ZXJpYWxPYmplY3QuaW5pdE5vbkNhc3RlckxpZ2h0UGFzc2VzIiwiUmVuZGVyTWV0aG9kTWF0ZXJpYWxPYmplY3QucmVtb3ZlTm9uQ2FzdGVyTGlnaHRQYXNzZXMiLCJSZW5kZXJNZXRob2RNYXRlcmlhbE9iamVjdC5yZW1vdmVFZmZlY3RQYXNzIiwiUmVuZGVyTWV0aG9kTWF0ZXJpYWxPYmplY3QuaW5pdEVmZmVjdFBhc3MiLCJSZW5kZXJNZXRob2RNYXRlcmlhbE9iamVjdC5kaXNwb3NlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFRQSxJQUFPLFNBQVMsV0FBZ0IsZ0NBQWdDLENBQUMsQ0FBQztBQUlsRSxJQUFPLGlCQUFpQixXQUFjLDZEQUE2RCxDQUFDLENBQUM7QUFHckcsSUFBTyxvQkFBb0IsV0FBYyw4Q0FBOEMsQ0FBQyxDQUFDO0FBTXpGLElBQU8sZ0JBQWdCLFdBQWUsb0RB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QSxDQUFDQSxTQUFTQSxDQUFDQSxhQUFhQSxDQUFDQTtZQUM5REEsSUFBSUEsQ0FBQ0EsV0FBV0EsQ0FBQ0EsYUFBYUEsR0FBR0EsSUFBSUEsQ0FBQ0EsU0FBU0EsQ0FBQ0EsYUFBYUEsQ0FBQ0E7WUFDOURBLElBQUlBLENBQUNBLFdBQVdBLENBQUNBLGNBQWNBLEdBQUdBLElBQUlBLENBQUNBLFNBQVNBLENBQUNBLGNBQWNBLENBQUNBO1lBQ2hFQSxJQUFJQSxDQUFDQSxXQUFXQSxDQUFDQSxZQUFZQSxHQUFHQSxJQUFJQSxDQUFDQSxTQUFTQSxDQUFDQSxZQUFZQSxDQUFDQTtZQUM1REEsSUFBSUEsQ0FBQ0EsV0FBV0EsQ0FBQ0EsWUFBWUEsR0FBR0EsSUFBSUEsQ0FBQ0EsU0FBU0EsQ0FBQ0EsWUFBWUEsQ0FBQ0E7UUFDN0RBLENBQUNBO1FBQUNBLElBQUlBLENBQUNBLEVBQUVBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLFNBQVNBLENBQUNBLElBQUlBLElBQUlBLGtCQUFrQkEsQ0FBQ0EsVUFBVUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFDakVBLEVBQUVBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLFNBQVNBLElBQUlBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO2dCQUN6QkEsSUFBSUEsQ0FBQ0EsV0FBV0EsQ0FBQ0EsYUFBYUEsR0FBR0EsSUFBSUEsQ0FBQ0EsU0FBU0EsQ0FBQ0EsYUFBYUEsQ0FBQ0E7WUFDL0RBLENBQUNBO1lBQUNBLElBQUlBLENBQUNBLENBQUNBO2dCQUNQQSxJQUFJQSxDQUFDQSxXQUFXQSxDQUFDQSxhQUFhQSxHQUFHQSxJQUFJQSxDQUFDQTtZQUN2Q0EsQ0FBQ0E7WUFFREEsSUFBSUEsQ0FBQ0EsV0FBV0EsQ0FBQ0EsYUFBYUEsR0FBR0EsS0FBS0EsQ0FBQ0E7WUFDdkNBLElBQUlBLENBQUNBLFdBQVdBLENBQUNBLFlBQVlBLEdBQUdBLElBQUlBLENBQUNBLFNBQVNBLENBQUNBLFlBQVlBLENBQUNBO1FBQzdEQSxDQUFDQTtRQUVEQSxBQUNBQSx1QkFEdUJBO1lBQ25CQSxDQUFDQSxHQUFVQSxDQUFDQSxDQUFDQTtRQUNqQkEsSUFBSUEsWUFBNkJBLENBQUNBO1FBQ2xDQSxJQUFJQSxHQUFHQSxHQUFVQSxJQUFJQSxDQUFDQSxHQUFHQSxDQUFDQSxJQUFJQSxDQUFDQSxTQUFTQSxDQUFDQSxnQkFBZ0JBLEVBQUVBLElBQUlBLENBQUNBLFdBQVdBLENBQUNBLGdCQUFnQkEsQ0FBQ0EsQ0FBQ0E7UUFFOUZBLE9BQU9BLENBQUNBLEdBQUdBLEdBQUdBLEVBQUVBLENBQUNBO1lBQ2hCQSxZQUFZQSxHQUFHQSxJQUFJQSxDQUFDQSxTQUFTQSxDQUFDQSxpQkFBaUJBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO1lBQ25EQSxFQUFFQSxDQUFDQSxDQUFDQSxZQUFZQSxJQUFJQSxJQUFJQSxDQUFDQSxXQUFXQSxDQUFDQSxpQkFBaUJBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO2dCQUMzREEsSUFBSUEsQ0FBQ0EsV0FBV0EsQ0FBQ0Esb0JBQW9CQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtnQkFFekNBLEVBQUVBLENBQUNBLENBQUNBLFlBQVlBLElBQUlBLElBQUlBLENBQUNBLENBQUNBLENBQUNBO29CQUMxQkEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0EsV0FBV0EsQ0FBQ0EsZ0JBQWdCQSxDQUFDQTt3QkFDekNBLElBQUlBLENBQUNBLFdBQVdBLENBQUNBLGlCQUFpQkEsQ0FBQ0EsWUFBWUEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7b0JBQ3JEQSxJQUFJQTt3QkFDSEEsSUFBSUEsQ0FBQ0EsV0FBV0EsQ0FBQ0EsZUFBZUEsQ0FBQ0EsWUFBWUEsQ0FBQ0EsQ0FBQ0E7Z0JBQ2pEQSxDQUFDQTtZQUNGQSxDQUFDQTtZQUVEQSxDQUFDQSxFQUFFQSxDQUFDQTtRQUNMQSxDQUFDQTtJQUNGQSxDQUFDQTtJQUVEWjs7T0FFR0E7SUFDSUEsNENBQU9BLEdBQWRBO1FBRUNhLGdCQUFLQSxDQUFDQSxPQUFPQSxXQUFFQSxDQUFDQTtRQUVoQkEsTUFBTUE7SUFDUEEsQ0FBQ0E7SUE5UkRiOztPQUVHQTtJQUNXQSw2QkFBRUEsR0FBVUEsUUFBUUEsQ0FBQ0E7SUE0UnBDQSxpQ0FBQ0E7QUFBREEsQ0FqU0EsQUFpU0NBLEVBalN3QyxnQkFBZ0IsRUFpU3hEO0FBRUQsQUFBb0MsaUJBQTNCLDBCQUEwQixDQUFDIiwiZmlsZSI6ImNvbXBpbGF0aW9uL1JlbmRlck1ldGhvZE1hdGVyaWFsT2JqZWN0LmpzIiwic291cmNlUm9vdCI6Ii4uLyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBDb2xvclRyYW5zZm9ybVx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvZ2VvbS9Db2xvclRyYW5zZm9ybVwiKTtcclxuaW1wb3J0IE1hdHJpeFx0XHRcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL2dlb20vTWF0cml4XCIpO1xyXG5pbXBvcnQgTWF0cml4M0RcdFx0XHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi9nZW9tL01hdHJpeDNEXCIpO1xyXG5pbXBvcnQgTWF0cml4M0RVdGlsc1x0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvZ2VvbS9NYXRyaXgzRFV0aWxzXCIpO1xyXG5pbXBvcnQgVmVjdG9yM0RcdFx0XHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi9nZW9tL1ZlY3RvcjNEXCIpO1xyXG5pbXBvcnQgQWJzdHJhY3RNZXRob2RFcnJvclx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL2Vycm9ycy9BYnN0cmFjdE1ldGhvZEVycm9yXCIpO1xyXG5pbXBvcnQgVGV4dHVyZTJEQmFzZVx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvdGV4dHVyZXMvVGV4dHVyZTJEQmFzZVwiKTtcclxuXHJcbmltcG9ydCBCbGVuZE1vZGVcdFx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvYmFzZS9CbGVuZE1vZGVcIik7XHJcbmltcG9ydCBUcmlhbmdsZVN1Ykdlb21ldHJ5XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtZGlzcGxheS9saWIvYmFzZS9UcmlhbmdsZVN1Ykdlb21ldHJ5XCIpO1xyXG5pbXBvcnQgQ2FtZXJhXHRcdFx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtZGlzcGxheS9saWIvZW50aXRpZXMvQ2FtZXJhXCIpO1xyXG5pbXBvcnQgSVJlbmRlck9iamVjdE93bmVyXHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtZGlzcGxheS9saWIvYmFzZS9JUmVuZGVyT2JqZWN0T3duZXJcIik7XHJcbmltcG9ydCBTdGF0aWNMaWdodFBpY2tlclx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWRpc3BsYXkvbGliL21hdGVyaWFscy9saWdodHBpY2tlcnMvU3RhdGljTGlnaHRQaWNrZXJcIik7XHJcblxyXG5pbXBvcnQgU3RhZ2VcdFx0XHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1zdGFnZWdsL2xpYi9iYXNlL1N0YWdlXCIpO1xyXG5pbXBvcnQgQ29udGV4dEdMQ29tcGFyZU1vZGVcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1zdGFnZWdsL2xpYi9iYXNlL0NvbnRleHRHTENvbXBhcmVNb2RlXCIpO1xyXG5cclxuaW1wb3J0IFJlbmRlcmVyQmFzZVx0XHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1yZW5kZXJlcmdsL2xpYi9iYXNlL1JlbmRlcmVyQmFzZVwiKTtcclxuaW1wb3J0IFJlbmRlck9iamVjdFBvb2xcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXJlbmRlcmVyZ2wvbGliL2NvbXBpbGF0aW9uL1JlbmRlck9iamVjdFBvb2xcIik7XHJcbmltcG9ydCBTaGFkaW5nTWV0aG9kRXZlbnRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1yZW5kZXJlcmdsL2xpYi9ldmVudHMvU2hhZGluZ01ldGhvZEV2ZW50XCIpO1xyXG5pbXBvcnQgU2hhZGVyT2JqZWN0QmFzZVx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtcmVuZGVyZXJnbC9saWIvY29tcGlsYXRpb24vU2hhZGVyT2JqZWN0QmFzZVwiKTtcclxuaW1wb3J0IFJlbmRlck9iamVjdEJhc2VcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXJlbmRlcmVyZ2wvbGliL2NvbXBpbGF0aW9uL1JlbmRlck9iamVjdEJhc2VcIik7XHJcbmltcG9ydCBSZW5kZXJhYmxlQmFzZVx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtcmVuZGVyZXJnbC9saWIvcG9vbC9SZW5kZXJhYmxlQmFzZVwiKTtcclxuaW1wb3J0IElSZW5kZXJhYmxlQ2xhc3NcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXJlbmRlcmVyZ2wvbGliL3Bvb2wvSVJlbmRlcmFibGVDbGFzc1wiKTtcclxuXHJcbmltcG9ydCBNZXRob2RNYXRlcmlhbFx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtbWV0aG9kbWF0ZXJpYWxzL2xpYi9NZXRob2RNYXRlcmlhbFwiKTtcclxuaW1wb3J0IE1ldGhvZFBhc3NNb2RlXHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1tZXRob2RtYXRlcmlhbHMvbGliL3Bhc3Nlcy9NZXRob2RQYXNzTW9kZVwiKTtcclxuaW1wb3J0IE1ldGhvZFBhc3NcdFx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtbWV0aG9kbWF0ZXJpYWxzL2xpYi9wYXNzZXMvTWV0aG9kUGFzc1wiKTtcclxuaW1wb3J0IEFtYmllbnRCYXNpY01ldGhvZFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLW1ldGhvZG1hdGVyaWFscy9saWIvbWV0aG9kcy9BbWJpZW50QmFzaWNNZXRob2RcIik7XHJcbmltcG9ydCBEaWZmdXNlQmFzaWNNZXRob2RcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1tZXRob2RtYXRlcmlhbHMvbGliL21ldGhvZHMvRGlmZnVzZUJhc2ljTWV0aG9kXCIpO1xyXG5pbXBvcnQgRWZmZWN0Q29sb3JUcmFuc2Zvcm1NZXRob2RcdFx0PSByZXF1aXJlKFwiYXdheWpzLW1ldGhvZG1hdGVyaWFscy9saWIvbWV0aG9kcy9FZmZlY3RDb2xvclRyYW5zZm9ybU1ldGhvZFwiKTtcclxuaW1wb3J0IEVmZmVjdE1ldGhvZEJhc2VcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLW1ldGhvZG1hdGVyaWFscy9saWIvbWV0aG9kcy9FZmZlY3RNZXRob2RCYXNlXCIpO1xyXG5pbXBvcnQgTGlnaHRpbmdNZXRob2RCYXNlXHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtbWV0aG9kbWF0ZXJpYWxzL2xpYi9tZXRob2RzL0xpZ2h0aW5nTWV0aG9kQmFzZVwiKTtcclxuaW1wb3J0IE5vcm1hbEJhc2ljTWV0aG9kXHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtbWV0aG9kbWF0ZXJpYWxzL2xpYi9tZXRob2RzL05vcm1hbEJhc2ljTWV0aG9kXCIpO1xyXG5pbXBvcnQgU2hhZG93TWFwTWV0aG9kQmFzZVx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLW1ldGhvZG1hdGVyaWFscy9saWIvbWV0aG9kcy9TaGFkb3dNYXBNZXRob2RCYXNlXCIpO1xyXG5pbXBvcnQgU3BlY3VsYXJCYXNpY01ldGhvZFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLW1ldGhvZG1hdGVyaWFscy9saWIvbWV0aG9kcy9TcGVjdWxhckJhc2ljTWV0aG9kXCIpO1xyXG5pbXBvcnQgTWV0aG9kTWF0ZXJpYWxNb2RlXHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtbWV0aG9kbWF0ZXJpYWxzL2xpYi9NZXRob2RNYXRlcmlhbE1vZGVcIik7XHJcblxyXG4vKipcclxuICogQ29tcGlsZWRQYXNzIGZvcm1zIGFuIGFic3RyYWN0IGJhc2UgY2xhc3MgZm9yIHRoZSBkZWZhdWx0IGNvbXBpbGVkIHBhc3MgbWF0ZXJpYWxzIHByb3ZpZGVkIGJ5IEF3YXkzRCxcclxuICogdXNpbmcgbWF0ZXJpYWwgbWV0aG9kcyB0byBkZWZpbmUgdGhlaXIgYXBwZWFyYW5jZS5cclxuICovXHJcbmNsYXNzIFJlbmRlck1ldGhvZE1hdGVyaWFsT2JqZWN0IGV4dGVuZHMgUmVuZGVyT2JqZWN0QmFzZVxyXG57XHJcblx0LyoqXHJcblx0ICpcclxuXHQgKi9cclxuXHRwdWJsaWMgc3RhdGljIGlkOnN0cmluZyA9IFwibWV0aG9kXCI7XHJcblxyXG5cdHByaXZhdGUgX21hdGVyaWFsOk1ldGhvZE1hdGVyaWFsO1xyXG5cdHByaXZhdGUgX3NjcmVlblBhc3M6TWV0aG9kUGFzcztcclxuXHRwcml2YXRlIF9jYXN0ZXJMaWdodFBhc3M6TWV0aG9kUGFzcztcclxuXHRwcml2YXRlIF9ub25DYXN0ZXJMaWdodFBhc3NlczpBcnJheTxNZXRob2RQYXNzPjtcclxuXHRcclxuXHQvKipcclxuXHQgKiBUaGUgbWF4aW11bSB0b3RhbCBudW1iZXIgb2YgbGlnaHRzIHByb3ZpZGVkIGJ5IHRoZSBsaWdodCBwaWNrZXIuXHJcblx0ICovXHJcblx0cHJpdmF0ZSBnZXQgbnVtTGlnaHRzKCk6bnVtYmVyXHJcblx0e1xyXG5cdFx0cmV0dXJuIHRoaXMuX21hdGVyaWFsLmxpZ2h0UGlja2VyPyB0aGlzLl9tYXRlcmlhbC5saWdodFBpY2tlci5udW1MaWdodFByb2JlcyArIHRoaXMuX21hdGVyaWFsLmxpZ2h0UGlja2VyLm51bURpcmVjdGlvbmFsTGlnaHRzICsgdGhpcy5fbWF0ZXJpYWwubGlnaHRQaWNrZXIubnVtUG9pbnRMaWdodHMgKyB0aGlzLl9tYXRlcmlhbC5saWdodFBpY2tlci5udW1DYXN0aW5nRGlyZWN0aW9uYWxMaWdodHMgKyB0aGlzLl9tYXRlcmlhbC5saWdodFBpY2tlci5udW1DYXN0aW5nUG9pbnRMaWdodHMgOiAwO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogVGhlIGFtb3VudCBvZiBsaWdodHMgdGhhdCBkb24ndCBjYXN0IHNoYWRvd3MuXHJcblx0ICovXHJcblx0cHJpdmF0ZSBnZXQgbnVtTm9uQ2FzdGVycygpOm51bWJlclxyXG5cdHtcclxuXHRcdHJldHVybiB0aGlzLl9tYXRlcmlhbC5saWdodFBpY2tlcj8gdGhpcy5fbWF0ZXJpYWwubGlnaHRQaWNrZXIubnVtTGlnaHRQcm9iZXMgKyB0aGlzLl9tYXRlcmlhbC5saWdodFBpY2tlci5udW1EaXJlY3Rpb25hbExpZ2h0cyArIHRoaXMuX21hdGVyaWFsLmxpZ2h0UGlja2VyLm51bVBvaW50TGlnaHRzIDogMDtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIENyZWF0ZXMgYSBuZXcgQ29tcGlsZWRQYXNzIG9iamVjdC5cclxuXHQgKlxyXG5cdCAqIEBwYXJhbSBtYXRlcmlhbCBUaGUgbWF0ZXJpYWwgdG8gd2hpY2ggdGhpcyBwYXNzIGJlbG9uZ3MuXHJcblx0ICovXHJcblx0Y29uc3RydWN0b3IocG9vbDpSZW5kZXJPYmplY3RQb29sLCBtYXRlcmlhbDpNZXRob2RNYXRlcmlhbCwgcmVuZGVyYWJsZUNsYXNzOklSZW5kZXJhYmxlQ2xhc3MsIHN0YWdlOlN0YWdlKVxyXG5cdHtcclxuXHRcdHN1cGVyKHBvb2wsIG1hdGVyaWFsLCByZW5kZXJhYmxlQ2xhc3MsIHN0YWdlKTtcclxuXHJcblx0XHR0aGlzLl9tYXRlcmlhbCA9IG1hdGVyaWFsO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQGluaGVyaXREb2NcclxuXHQgKi9cclxuXHRwdWJsaWMgX3BVcGRhdGVSZW5kZXJPYmplY3QoKVxyXG5cdHtcclxuXHRcdHN1cGVyLl9wVXBkYXRlUmVuZGVyT2JqZWN0KCk7XHJcblxyXG5cdFx0dGhpcy5pbml0UGFzc2VzKCk7XHJcblxyXG5cdFx0dGhpcy5zZXRCbGVuZEFuZENvbXBhcmVNb2RlcygpO1xyXG5cclxuXHRcdHRoaXMuX3BDbGVhclNjcmVlblBhc3NlcygpO1xyXG5cclxuXHRcdGlmICh0aGlzLl9tYXRlcmlhbC5tb2RlID09IE1ldGhvZE1hdGVyaWFsTW9kZS5NVUxUSV9QQVNTKSB7XHJcblx0XHRcdGlmICh0aGlzLl9jYXN0ZXJMaWdodFBhc3MpXHJcblx0XHRcdFx0dGhpcy5fcEFkZFNjcmVlblBhc3ModGhpcy5fY2FzdGVyTGlnaHRQYXNzKTtcclxuXHJcblx0XHRcdGlmICh0aGlzLl9ub25DYXN0ZXJMaWdodFBhc3NlcylcclxuXHRcdFx0XHRmb3IgKHZhciBpOm51bWJlciA9IDA7IGkgPCB0aGlzLl9ub25DYXN0ZXJMaWdodFBhc3Nlcy5sZW5ndGg7ICsraSlcclxuXHRcdFx0XHRcdHRoaXMuX3BBZGRTY3JlZW5QYXNzKHRoaXMuX25vbkNhc3RlckxpZ2h0UGFzc2VzW2ldKTtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAodGhpcy5fc2NyZWVuUGFzcylcclxuXHRcdFx0dGhpcy5fcEFkZFNjcmVlblBhc3ModGhpcy5fc2NyZWVuUGFzcyk7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBJbml0aWFsaXplcyBhbGwgdGhlIHBhc3NlcyBhbmQgdGhlaXIgZGVwZW5kZW50IHBhc3Nlcy5cclxuXHQgKi9cclxuXHRwcml2YXRlIGluaXRQYXNzZXMoKVxyXG5cdHtcclxuXHRcdC8vIGxldCB0aGUgZWZmZWN0cyBwYXNzIGhhbmRsZSBldmVyeXRoaW5nIGlmIHRoZXJlIGFyZSBubyBsaWdodHMsIHdoZW4gdGhlcmUgYXJlIGVmZmVjdCBtZXRob2RzIGFwcGxpZWRcclxuXHRcdC8vIGFmdGVyIHNoYWRpbmcsIG9yIHdoZW4gdGhlIG1hdGVyaWFsIG1vZGUgaXMgc2luZ2xlIHBhc3MuXHJcblx0XHRpZiAodGhpcy5udW1MaWdodHMgPT0gMCB8fCB0aGlzLl9tYXRlcmlhbC5udW1FZmZlY3RNZXRob2RzID4gMCB8fCB0aGlzLl9tYXRlcmlhbC5tb2RlID09IE1ldGhvZE1hdGVyaWFsTW9kZS5TSU5HTEVfUEFTUylcclxuXHRcdFx0dGhpcy5pbml0RWZmZWN0UGFzcygpO1xyXG5cdFx0ZWxzZSBpZiAodGhpcy5fc2NyZWVuUGFzcylcclxuXHRcdFx0dGhpcy5yZW1vdmVFZmZlY3RQYXNzKCk7XHJcblxyXG5cdFx0Ly8gb25seSB1c2UgYSBjYXN0ZXIgbGlnaHQgcGFzcyBpZiBzaGFkb3dzIG5lZWQgdG8gYmUgcmVuZGVyZWRcclxuXHRcdGlmICh0aGlzLl9tYXRlcmlhbC5zaGFkb3dNZXRob2QgJiYgdGhpcy5fbWF0ZXJpYWwubW9kZSA9PSBNZXRob2RNYXRlcmlhbE1vZGUuTVVMVElfUEFTUylcclxuXHRcdFx0dGhpcy5pbml0Q2FzdGVyTGlnaHRQYXNzKCk7XHJcblx0XHRlbHNlIGlmICh0aGlzLl9jYXN0ZXJMaWdodFBhc3MpXHJcblx0XHRcdHRoaXMucmVtb3ZlQ2FzdGVyTGlnaHRQYXNzKCk7XHJcblxyXG5cdFx0Ly8gb25seSB1c2Ugbm9uIGNhc3RlciBsaWdodCBwYXNzZXMgaWYgdGhlcmUgYXJlIGxpZ2h0cyB0aGF0IGRvbid0IGNhc3RcclxuXHRcdGlmICh0aGlzLm51bU5vbkNhc3RlcnMgPiAwICYmIHRoaXMuX21hdGVyaWFsLm1vZGUgPT0gTWV0aG9kTWF0ZXJpYWxNb2RlLk1VTFRJX1BBU1MpXHJcblx0XHRcdHRoaXMuaW5pdE5vbkNhc3RlckxpZ2h0UGFzc2VzKCk7XHJcblx0XHRlbHNlIGlmICh0aGlzLl9ub25DYXN0ZXJMaWdodFBhc3NlcylcclxuXHRcdFx0dGhpcy5yZW1vdmVOb25DYXN0ZXJMaWdodFBhc3NlcygpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogU2V0cyB1cCB0aGUgdmFyaW91cyBibGVuZGluZyBtb2RlcyBmb3IgYWxsIHNjcmVlbiBwYXNzZXMsIGJhc2VkIG9uIHdoZXRoZXIgb3Igbm90IHRoZXJlIGFyZSBwcmV2aW91cyBwYXNzZXMuXHJcblx0ICovXHJcblx0cHJpdmF0ZSBzZXRCbGVuZEFuZENvbXBhcmVNb2RlcygpXHJcblx0e1xyXG5cdFx0dmFyIGZvcmNlU2VwYXJhdGVNVlA6Ym9vbGVhbiA9IEJvb2xlYW4odGhpcy5fY2FzdGVyTGlnaHRQYXNzIHx8IHRoaXMuX3NjcmVlblBhc3MpO1xyXG5cclxuXHRcdC8vIGNhc3RlciBsaWdodCBwYXNzIGlzIGFsd2F5cyBmaXJzdCBpZiBpdCBleGlzdHMsIGhlbmNlIGl0IHVzZXMgbm9ybWFsIGJsZW5kaW5nXHJcblx0XHRpZiAodGhpcy5fY2FzdGVyTGlnaHRQYXNzKSB7XHJcblx0XHRcdHRoaXMuX2Nhc3RlckxpZ2h0UGFzcy5mb3JjZVNlcGFyYXRlTVZQID0gZm9yY2VTZXBhcmF0ZU1WUDtcclxuXHRcdFx0dGhpcy5fY2FzdGVyTGlnaHRQYXNzLnNldEJsZW5kTW9kZShCbGVuZE1vZGUuTk9STUFMKTtcclxuXHRcdFx0dGhpcy5fY2FzdGVyTGlnaHRQYXNzLmRlcHRoQ29tcGFyZU1vZGUgPSB0aGlzLl9tYXRlcmlhbC5kZXB0aENvbXBhcmVNb2RlO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmICh0aGlzLl9ub25DYXN0ZXJMaWdodFBhc3Nlcykge1xyXG5cdFx0XHR2YXIgZmlyc3RBZGRpdGl2ZUluZGV4Om51bWJlciA9IDA7XHJcblxyXG5cdFx0XHQvLyBpZiB0aGVyZSdzIG5vIGNhc3RlciBsaWdodCBwYXNzLCB0aGUgZmlyc3Qgbm9uIGNhc3RlciBsaWdodCBwYXNzIHdpbGwgYmUgdGhlIGZpcnN0XHJcblx0XHRcdC8vIGFuZCBzaG91bGQgdXNlIG5vcm1hbCBibGVuZGluZ1xyXG5cdFx0XHRpZiAoIXRoaXMuX2Nhc3RlckxpZ2h0UGFzcykge1xyXG5cdFx0XHRcdHRoaXMuX25vbkNhc3RlckxpZ2h0UGFzc2VzWzBdLmZvcmNlU2VwYXJhdGVNVlAgPSBmb3JjZVNlcGFyYXRlTVZQO1xyXG5cdFx0XHRcdHRoaXMuX25vbkNhc3RlckxpZ2h0UGFzc2VzWzBdLnNldEJsZW5kTW9kZShCbGVuZE1vZGUuTk9STUFMKTtcclxuXHRcdFx0XHR0aGlzLl9ub25DYXN0ZXJMaWdodFBhc3Nlc1swXS5kZXB0aENvbXBhcmVNb2RlID0gdGhpcy5fbWF0ZXJpYWwuZGVwdGhDb21wYXJlTW9kZTtcclxuXHRcdFx0XHRmaXJzdEFkZGl0aXZlSW5kZXggPSAxO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHQvLyBhbGwgbGlnaHRpbmcgcGFzc2VzIGZvbGxvd2luZyB0aGUgZmlyc3QgbGlnaHQgcGFzcyBzaG91bGQgdXNlIGFkZGl0aXZlIGJsZW5kaW5nXHJcblx0XHRcdGZvciAodmFyIGk6bnVtYmVyID0gZmlyc3RBZGRpdGl2ZUluZGV4OyBpIDwgdGhpcy5fbm9uQ2FzdGVyTGlnaHRQYXNzZXMubGVuZ3RoOyArK2kpIHtcclxuXHRcdFx0XHR0aGlzLl9ub25DYXN0ZXJMaWdodFBhc3Nlc1tpXS5mb3JjZVNlcGFyYXRlTVZQID0gZm9yY2VTZXBhcmF0ZU1WUDtcclxuXHRcdFx0XHR0aGlzLl9ub25DYXN0ZXJMaWdodFBhc3Nlc1tpXS5zZXRCbGVuZE1vZGUoQmxlbmRNb2RlLkFERCk7XHJcblx0XHRcdFx0dGhpcy5fbm9uQ2FzdGVyTGlnaHRQYXNzZXNbaV0uZGVwdGhDb21wYXJlTW9kZSA9IENvbnRleHRHTENvbXBhcmVNb2RlLkxFU1NfRVFVQUw7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRpZiAodGhpcy5fY2FzdGVyTGlnaHRQYXNzIHx8IHRoaXMuX25vbkNhc3RlckxpZ2h0UGFzc2VzKSB7XHJcblx0XHRcdC8vY2Fubm90IGJlIGJsZW5kZWQgYnkgYmxlbmRtb2RlIHByb3BlcnR5IGlmIG11bHRpcGFzcyBlbmFibGVkXHJcblx0XHRcdHRoaXMuX3BSZXF1aXJlc0JsZW5kaW5nID0gZmFsc2U7XHJcblxyXG5cdFx0XHQvLyB0aGVyZSBhcmUgbGlnaHQgcGFzc2VzLCBzbyB0aGlzIHNob3VsZCBiZSBibGVuZGVkIGluXHJcblx0XHRcdGlmICh0aGlzLl9zY3JlZW5QYXNzKSB7XHJcblx0XHRcdFx0dGhpcy5fc2NyZWVuUGFzcy5tb2RlID0gTWV0aG9kUGFzc01vZGUuRUZGRUNUUztcclxuXHRcdFx0XHR0aGlzLl9zY3JlZW5QYXNzLmRlcHRoQ29tcGFyZU1vZGUgPSBDb250ZXh0R0xDb21wYXJlTW9kZS5MRVNTX0VRVUFMO1xyXG5cdFx0XHRcdHRoaXMuX3NjcmVlblBhc3Muc2V0QmxlbmRNb2RlKEJsZW5kTW9kZS5MQVlFUik7XHJcblx0XHRcdFx0dGhpcy5fc2NyZWVuUGFzcy5mb3JjZVNlcGFyYXRlTVZQID0gZm9yY2VTZXBhcmF0ZU1WUDtcclxuXHRcdFx0fVxyXG5cclxuXHRcdH0gZWxzZSBpZiAodGhpcy5fc2NyZWVuUGFzcykge1xyXG5cdFx0XHR0aGlzLl9wUmVxdWlyZXNCbGVuZGluZyA9ICh0aGlzLl9tYXRlcmlhbC5ibGVuZE1vZGUgIT0gQmxlbmRNb2RlLk5PUk1BTCB8fCB0aGlzLl9tYXRlcmlhbC5hbHBoYUJsZW5kaW5nIHx8ICh0aGlzLl9tYXRlcmlhbC5jb2xvclRyYW5zZm9ybSAmJiB0aGlzLl9tYXRlcmlhbC5jb2xvclRyYW5zZm9ybS5hbHBoYU11bHRpcGxpZXIgPCAxKSk7XHJcblx0XHRcdC8vIGVmZmVjdHMgcGFzcyBpcyB0aGUgb25seSBwYXNzLCBzbyBpdCBzaG91bGQganVzdCBibGVuZCBub3JtYWxseVxyXG5cdFx0XHR0aGlzLl9zY3JlZW5QYXNzLm1vZGUgPSBNZXRob2RQYXNzTW9kZS5TVVBFUl9TSEFERVI7XHJcblx0XHRcdHRoaXMuX3NjcmVlblBhc3MuZGVwdGhDb21wYXJlTW9kZSA9IHRoaXMuX21hdGVyaWFsLmRlcHRoQ29tcGFyZU1vZGU7XHJcblx0XHRcdHRoaXMuX3NjcmVlblBhc3MucHJlc2VydmVBbHBoYSA9IHRoaXMuX3BSZXF1aXJlc0JsZW5kaW5nO1xyXG5cdFx0XHR0aGlzLl9zY3JlZW5QYXNzLmNvbG9yVHJhbnNmb3JtID0gdGhpcy5fbWF0ZXJpYWwuY29sb3JUcmFuc2Zvcm07XHJcblx0XHRcdHRoaXMuX3NjcmVlblBhc3Muc2V0QmxlbmRNb2RlKCh0aGlzLl9tYXRlcmlhbC5ibGVuZE1vZGUgPT0gQmxlbmRNb2RlLk5PUk1BTCAmJiB0aGlzLl9wUmVxdWlyZXNCbGVuZGluZyk/IEJsZW5kTW9kZS5MQVlFUiA6IHRoaXMuX21hdGVyaWFsLmJsZW5kTW9kZSk7XHJcblx0XHRcdHRoaXMuX3NjcmVlblBhc3MuZm9yY2VTZXBhcmF0ZU1WUCA9IGZhbHNlO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSBpbml0Q2FzdGVyTGlnaHRQYXNzKClcclxuXHR7XHJcblxyXG5cdFx0aWYgKHRoaXMuX2Nhc3RlckxpZ2h0UGFzcyA9PSBudWxsKVxyXG5cdFx0XHR0aGlzLl9jYXN0ZXJMaWdodFBhc3MgPSBuZXcgTWV0aG9kUGFzcyhNZXRob2RQYXNzTW9kZS5MSUdIVElORywgdGhpcywgdGhpcy5fbWF0ZXJpYWwsIHRoaXMuX3JlbmRlcmFibGVDbGFzcywgdGhpcy5fc3RhZ2UpO1xyXG5cclxuXHRcdHRoaXMuX2Nhc3RlckxpZ2h0UGFzcy5saWdodFBpY2tlciA9IG5ldyBTdGF0aWNMaWdodFBpY2tlcihbdGhpcy5fbWF0ZXJpYWwuc2hhZG93TWV0aG9kLmNhc3RpbmdMaWdodF0pO1xyXG5cdFx0dGhpcy5fY2FzdGVyTGlnaHRQYXNzLnNoYWRvd01ldGhvZCA9IHRoaXMuX21hdGVyaWFsLnNoYWRvd01ldGhvZDtcclxuXHRcdHRoaXMuX2Nhc3RlckxpZ2h0UGFzcy5kaWZmdXNlTWV0aG9kID0gdGhpcy5fbWF0ZXJpYWwuZGlmZnVzZU1ldGhvZDtcclxuXHRcdHRoaXMuX2Nhc3RlckxpZ2h0UGFzcy5hbWJpZW50TWV0aG9kID0gdGhpcy5fbWF0ZXJpYWwuYW1iaWVudE1ldGhvZDtcclxuXHRcdHRoaXMuX2Nhc3RlckxpZ2h0UGFzcy5ub3JtYWxNZXRob2QgPSB0aGlzLl9tYXRlcmlhbC5ub3JtYWxNZXRob2Q7XHJcblx0XHR0aGlzLl9jYXN0ZXJMaWdodFBhc3Muc3BlY3VsYXJNZXRob2QgPSB0aGlzLl9tYXRlcmlhbC5zcGVjdWxhck1ldGhvZDtcclxuXHR9XHJcblxyXG5cdHByaXZhdGUgcmVtb3ZlQ2FzdGVyTGlnaHRQYXNzKClcclxuXHR7XHJcblx0XHR0aGlzLl9jYXN0ZXJMaWdodFBhc3MuZGlzcG9zZSgpO1xyXG5cdFx0dGhpcy5fcFJlbW92ZVNjcmVlblBhc3ModGhpcy5fY2FzdGVyTGlnaHRQYXNzKTtcclxuXHRcdHRoaXMuX2Nhc3RlckxpZ2h0UGFzcyA9IG51bGw7XHJcblx0fVxyXG5cclxuXHRwcml2YXRlIGluaXROb25DYXN0ZXJMaWdodFBhc3NlcygpXHJcblx0e1xyXG5cdFx0dGhpcy5yZW1vdmVOb25DYXN0ZXJMaWdodFBhc3NlcygpO1xyXG5cdFx0dmFyIHBhc3M6TWV0aG9kUGFzcztcclxuXHRcdHZhciBudW1EaXJMaWdodHM6bnVtYmVyID0gdGhpcy5fbWF0ZXJpYWwubGlnaHRQaWNrZXIubnVtRGlyZWN0aW9uYWxMaWdodHM7XHJcblx0XHR2YXIgbnVtUG9pbnRMaWdodHM6bnVtYmVyID0gdGhpcy5fbWF0ZXJpYWwubGlnaHRQaWNrZXIubnVtUG9pbnRMaWdodHM7XHJcblx0XHR2YXIgbnVtTGlnaHRQcm9iZXM6bnVtYmVyID0gdGhpcy5fbWF0ZXJpYWwubGlnaHRQaWNrZXIubnVtTGlnaHRQcm9iZXM7XHJcblx0XHR2YXIgZGlyTGlnaHRPZmZzZXQ6bnVtYmVyID0gMDtcclxuXHRcdHZhciBwb2ludExpZ2h0T2Zmc2V0Om51bWJlciA9IDA7XHJcblx0XHR2YXIgcHJvYmVPZmZzZXQ6bnVtYmVyID0gMDtcclxuXHJcblx0XHRpZiAoIXRoaXMuX2Nhc3RlckxpZ2h0UGFzcykge1xyXG5cdFx0XHRudW1EaXJMaWdodHMgKz0gdGhpcy5fbWF0ZXJpYWwubGlnaHRQaWNrZXIubnVtQ2FzdGluZ0RpcmVjdGlvbmFsTGlnaHRzO1xyXG5cdFx0XHRudW1Qb2ludExpZ2h0cyArPSB0aGlzLl9tYXRlcmlhbC5saWdodFBpY2tlci5udW1DYXN0aW5nUG9pbnRMaWdodHM7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5fbm9uQ2FzdGVyTGlnaHRQYXNzZXMgPSBuZXcgQXJyYXk8TWV0aG9kUGFzcz4oKTtcclxuXHJcblx0XHR3aGlsZSAoZGlyTGlnaHRPZmZzZXQgPCBudW1EaXJMaWdodHMgfHwgcG9pbnRMaWdodE9mZnNldCA8IG51bVBvaW50TGlnaHRzIHx8IHByb2JlT2Zmc2V0IDwgbnVtTGlnaHRQcm9iZXMpIHtcclxuXHRcdFx0cGFzcyA9IG5ldyBNZXRob2RQYXNzKE1ldGhvZFBhc3NNb2RlLkxJR0hUSU5HLCB0aGlzLCB0aGlzLl9tYXRlcmlhbCwgdGhpcy5fcmVuZGVyYWJsZUNsYXNzLCB0aGlzLl9zdGFnZSk7XHJcblx0XHRcdHBhc3MuaW5jbHVkZUNhc3RlcnMgPSB0aGlzLl9tYXRlcmlhbC5zaGFkb3dNZXRob2QgPT0gbnVsbDtcclxuXHRcdFx0cGFzcy5kaXJlY3Rpb25hbExpZ2h0c09mZnNldCA9IGRpckxpZ2h0T2Zmc2V0O1xyXG5cdFx0XHRwYXNzLnBvaW50TGlnaHRzT2Zmc2V0ID0gcG9pbnRMaWdodE9mZnNldDtcclxuXHRcdFx0cGFzcy5saWdodFByb2Jlc09mZnNldCA9IHByb2JlT2Zmc2V0O1xyXG5cdFx0XHRwYXNzLmxpZ2h0UGlja2VyID0gdGhpcy5fbWF0ZXJpYWwubGlnaHRQaWNrZXI7XHJcblx0XHRcdHBhc3MuZGlmZnVzZU1ldGhvZCA9IHRoaXMuX21hdGVyaWFsLmRpZmZ1c2VNZXRob2Q7XHJcblx0XHRcdHBhc3MuYW1iaWVudE1ldGhvZCA9IHRoaXMuX21hdGVyaWFsLmFtYmllbnRNZXRob2Q7XHJcblx0XHRcdHBhc3Mubm9ybWFsTWV0aG9kID0gdGhpcy5fbWF0ZXJpYWwubm9ybWFsTWV0aG9kO1xyXG5cdFx0XHRwYXNzLnNwZWN1bGFyTWV0aG9kID0gdGhpcy5fbWF0ZXJpYWwuc3BlY3VsYXJNZXRob2Q7XHJcblx0XHRcdHRoaXMuX25vbkNhc3RlckxpZ2h0UGFzc2VzLnB1c2gocGFzcyk7XHJcblxyXG5cdFx0XHRkaXJMaWdodE9mZnNldCArPSBwYXNzLm51bURpcmVjdGlvbmFsTGlnaHRzO1xyXG5cdFx0XHRwb2ludExpZ2h0T2Zmc2V0ICs9IHBhc3MubnVtUG9pbnRMaWdodHM7XHJcblx0XHRcdHByb2JlT2Zmc2V0ICs9IHBhc3MubnVtTGlnaHRQcm9iZXM7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRwcml2YXRlIHJlbW92ZU5vbkNhc3RlckxpZ2h0UGFzc2VzKClcclxuXHR7XHJcblx0XHRpZiAoIXRoaXMuX25vbkNhc3RlckxpZ2h0UGFzc2VzKVxyXG5cdFx0XHRyZXR1cm47XHJcblxyXG5cdFx0Zm9yICh2YXIgaTpudW1iZXIgPSAwOyBpIDwgdGhpcy5fbm9uQ2FzdGVyTGlnaHRQYXNzZXMubGVuZ3RoOyArK2kpXHJcblx0XHRcdHRoaXMuX3BSZW1vdmVTY3JlZW5QYXNzKHRoaXMuX25vbkNhc3RlckxpZ2h0UGFzc2VzW2ldKTtcclxuXHJcblx0XHR0aGlzLl9ub25DYXN0ZXJMaWdodFBhc3NlcyA9IG51bGw7XHJcblx0fVxyXG5cclxuXHRwcml2YXRlIHJlbW92ZUVmZmVjdFBhc3MoKVxyXG5cdHtcclxuXHRcdGlmICh0aGlzLl9zY3JlZW5QYXNzLmFtYmllbnRNZXRob2QgIT0gdGhpcy5fbWF0ZXJpYWwuYW1iaWVudE1ldGhvZClcclxuXHRcdFx0dGhpcy5fc2NyZWVuUGFzcy5hbWJpZW50TWV0aG9kLmRpc3Bvc2UoKTtcclxuXHJcblx0XHRpZiAodGhpcy5fc2NyZWVuUGFzcy5kaWZmdXNlTWV0aG9kICE9IHRoaXMuX21hdGVyaWFsLmRpZmZ1c2VNZXRob2QpXHJcblx0XHRcdHRoaXMuX3NjcmVlblBhc3MuZGlmZnVzZU1ldGhvZC5kaXNwb3NlKCk7XHJcblxyXG5cdFx0aWYgKHRoaXMuX3NjcmVlblBhc3Muc3BlY3VsYXJNZXRob2QgIT0gdGhpcy5fbWF0ZXJpYWwuc3BlY3VsYXJNZXRob2QpXHJcblx0XHRcdHRoaXMuX3NjcmVlblBhc3Muc3BlY3VsYXJNZXRob2QuZGlzcG9zZSgpO1xyXG5cclxuXHRcdGlmICh0aGlzLl9zY3JlZW5QYXNzLm5vcm1hbE1ldGhvZCAhPSB0aGlzLl9tYXRlcmlhbC5ub3JtYWxNZXRob2QpXHJcblx0XHRcdHRoaXMuX3NjcmVlblBhc3Mubm9ybWFsTWV0aG9kLmRpc3Bvc2UoKTtcclxuXHJcblx0XHR0aGlzLl9wUmVtb3ZlU2NyZWVuUGFzcyh0aGlzLl9zY3JlZW5QYXNzKTtcclxuXHRcdHRoaXMuX3NjcmVlblBhc3MgPSBudWxsO1xyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSBpbml0RWZmZWN0UGFzcygpXHJcblx0e1xyXG5cdFx0aWYgKHRoaXMuX3NjcmVlblBhc3MgPT0gbnVsbClcclxuXHRcdFx0dGhpcy5fc2NyZWVuUGFzcyA9IG5ldyBNZXRob2RQYXNzKE1ldGhvZFBhc3NNb2RlLlNVUEVSX1NIQURFUiwgdGhpcywgdGhpcy5fbWF0ZXJpYWwsIHRoaXMuX3JlbmRlcmFibGVDbGFzcywgdGhpcy5fc3RhZ2UpO1xyXG5cclxuXHRcdGlmICh0aGlzLl9tYXRlcmlhbC5tb2RlID09IE1ldGhvZE1hdGVyaWFsTW9kZS5TSU5HTEVfUEFTUykge1xyXG5cdFx0XHR0aGlzLl9zY3JlZW5QYXNzLmFtYmllbnRNZXRob2QgPSB0aGlzLl9tYXRlcmlhbC5hbWJpZW50TWV0aG9kO1xyXG5cdFx0XHR0aGlzLl9zY3JlZW5QYXNzLmRpZmZ1c2VNZXRob2QgPSB0aGlzLl9tYXRlcmlhbC5kaWZmdXNlTWV0aG9kO1xyXG5cdFx0XHR0aGlzLl9zY3JlZW5QYXNzLnNwZWN1bGFyTWV0aG9kID0gdGhpcy5fbWF0ZXJpYWwuc3BlY3VsYXJNZXRob2Q7XHJcblx0XHRcdHRoaXMuX3NjcmVlblBhc3Mubm9ybWFsTWV0aG9kID0gdGhpcy5fbWF0ZXJpYWwubm9ybWFsTWV0aG9kO1xyXG5cdFx0XHR0aGlzLl9zY3JlZW5QYXNzLnNoYWRvd01ldGhvZCA9IHRoaXMuX21hdGVyaWFsLnNoYWRvd01ldGhvZDtcclxuXHRcdH0gZWxzZSBpZiAodGhpcy5fbWF0ZXJpYWwubW9kZSA9PSBNZXRob2RNYXRlcmlhbE1vZGUuTVVMVElfUEFTUykge1xyXG5cdFx0XHRpZiAodGhpcy5udW1MaWdodHMgPT0gMCkge1xyXG5cdFx0XHRcdHRoaXMuX3NjcmVlblBhc3MuYW1iaWVudE1ldGhvZCA9IHRoaXMuX21hdGVyaWFsLmFtYmllbnRNZXRob2Q7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0dGhpcy5fc2NyZWVuUGFzcy5hbWJpZW50TWV0aG9kID0gbnVsbDtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0dGhpcy5fc2NyZWVuUGFzcy5wcmVzZXJ2ZUFscGhhID0gZmFsc2U7XHJcblx0XHRcdHRoaXMuX3NjcmVlblBhc3Mubm9ybWFsTWV0aG9kID0gdGhpcy5fbWF0ZXJpYWwubm9ybWFsTWV0aG9kO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vdXBkYXRlIGVmZmVjdCBtZXRob2RzXHJcblx0XHR2YXIgaTpudW1iZXIgPSAwO1xyXG5cdFx0dmFyIGVmZmVjdE1ldGhvZDpFZmZlY3RNZXRob2RCYXNlO1xyXG5cdFx0dmFyIGxlbjpudW1iZXIgPSBNYXRoLm1heCh0aGlzLl9tYXRlcmlhbC5udW1FZmZlY3RNZXRob2RzLCB0aGlzLl9zY3JlZW5QYXNzLm51bUVmZmVjdE1ldGhvZHMpO1xyXG5cclxuXHRcdHdoaWxlIChpIDwgbGVuKSB7XHJcblx0XHRcdGVmZmVjdE1ldGhvZCA9IHRoaXMuX21hdGVyaWFsLmdldEVmZmVjdE1ldGhvZEF0KGkpO1xyXG5cdFx0XHRpZiAoZWZmZWN0TWV0aG9kICE9IHRoaXMuX3NjcmVlblBhc3MuZ2V0RWZmZWN0TWV0aG9kQXQoaSkpIHtcclxuXHRcdFx0XHR0aGlzLl9zY3JlZW5QYXNzLnJlbW92ZUVmZmVjdE1ldGhvZEF0KGkpO1xyXG5cclxuXHRcdFx0XHRpZiAoZWZmZWN0TWV0aG9kICE9IG51bGwpIHtcclxuXHRcdFx0XHRcdGlmIChpIDwgdGhpcy5fc2NyZWVuUGFzcy5udW1FZmZlY3RNZXRob2RzKVxyXG5cdFx0XHRcdFx0XHR0aGlzLl9zY3JlZW5QYXNzLmFkZEVmZmVjdE1ldGhvZEF0KGVmZmVjdE1ldGhvZCwgaSk7XHJcblx0XHRcdFx0XHRlbHNlXHJcblx0XHRcdFx0XHRcdHRoaXMuX3NjcmVlblBhc3MuYWRkRWZmZWN0TWV0aG9kKGVmZmVjdE1ldGhvZCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRpKys7XHJcblx0XHR9XHJcblx0fVxyXG5cdFxyXG5cdC8qKlxyXG5cdCAqIEBpbmhlcml0RG9jXHJcblx0ICovXHJcblx0cHVibGljIGRpc3Bvc2UoKVxyXG5cdHtcclxuXHRcdHN1cGVyLmRpc3Bvc2UoKTtcclxuXHJcblx0XHQvL1RPRE9cclxuXHR9XHJcbn1cclxuXHJcbmV4cG9ydCA9IFJlbmRlck1ldGhvZE1hdGVyaWFsT2JqZWN0OyJdfQ==