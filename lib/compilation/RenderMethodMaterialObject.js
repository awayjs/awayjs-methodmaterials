var __extends = this.__extends || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    __.prototype = b.prototype;
    d.prototype = new __();
};
var BlendMode = require("awayjs-display/lib/base/BlendMode");
var StaticLightPicker = require("awayjs-display/lib/materials/lightpickers/StaticLightPicker");
var ContextGLCompareMode = require("awayjs-stagegl/lib/base/ContextGLCompareMode");
var RenderObjectBase = require("awayjs-renderergl/lib/compilation/RenderObjectBase");
var MethodPassMode = require("awayjs-methodmaterials/lib/passes/MethodPassMode");
var MethodPass = require("awayjs-methodmaterials/lib/passes/MethodPass");
var MethodMaterialMode = require("awayjs-methodmaterials/lib/MethodMaterialMode");
/**
 * CompiledPass forms an abstract base class for the default compiled pass materials provided by Away3D,
 * using material methods to define their appearance.
 */
var RenderMethodMaterialObject = (function (_super) {
    __extends(RenderMethodMaterialObject, _super);
    /**
     * Creates a new CompiledPass object.
     *
     * @param material The material to which this pass belongs.
     */
    function RenderMethodMaterialObject(pool, material, renderableClass, stage) {
        _super.call(this, pool, material, renderableClass, stage);
        this._material = material;
    }
    Object.defineProperty(RenderMethodMaterialObject.prototype, "numLights", {
        /**
         * The maximum total number of lights provided by the light picker.
         */
        get: function () {
            return this._material.lightPicker ? this._material.lightPicker.numLightProbes + this._material.lightPicker.numDirectionalLights + this._material.lightPicker.numPointLights + this._material.lightPicker.numCastingDirectionalLights + this._material.lightPicker.numCastingPointLights : 0;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RenderMethodMaterialObject.prototype, "numNonCasters", {
        /**
         * The amount of lights that don't cast shadows.
         */
        get: function () {
            return this._material.lightPicker ? this._material.lightPicker.numLightProbes + this._material.lightPicker.numDirectionalLights + this._material.lightPicker.numPointLights : 0;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @inheritDoc
     */
    RenderMethodMaterialObject.prototype._pUpdateRenderObject = function () {
        _super.prototype._pUpdateRenderObject.call(this);
        this.initPasses();
        this.setBlendAndCompareModes();
        this._pClearScreenPasses();
        if (this._material.mode == MethodMaterialMode.MULTI_PASS) {
            if (this._casterLightPass)
                this._pAddScreenPass(this._casterLightPass);
            if (this._nonCasterLightPasses)
                for (var i = 0; i < this._nonCasterLightPasses.length; ++i)
                    this._pAddScreenPass(this._nonCasterLightPasses[i]);
        }
        if (this._screenPass)
            this._pAddScreenPass(this._screenPass);
    };
    /**
     * Initializes all the passes and their dependent passes.
     */
    RenderMethodMaterialObject.prototype.initPasses = function () {
        // let the effects pass handle everything if there are no lights, when there are effect methods applied
        // after shading, or when the material mode is single pass.
        if (this.numLights == 0 || this._material.numEffectMethods > 0 || this._material.mode == MethodMaterialMode.SINGLE_PASS)
            this.initEffectPass();
        else if (this._screenPass)
            this.removeEffectPass();
        // only use a caster light pass if shadows need to be rendered
        if (this._material.shadowMethod && this._material.mode == MethodMaterialMode.MULTI_PASS)
            this.initCasterLightPass();
        else if (this._casterLightPass)
            this.removeCasterLightPass();
        // only use non caster light passes if there are lights that don't cast
        if (this.numNonCasters > 0 && this._material.mode == MethodMaterialMode.MULTI_PASS)
            this.initNonCasterLightPasses();
        else if (this._nonCasterLightPasses)
            this.removeNonCasterLightPasses();
    };
    /**
     * Sets up the various blending modes for all screen passes, based on whether or not there are previous passes.
     */
    RenderMethodMaterialObject.prototype.setBlendAndCompareModes = function () {
        var forceSeparateMVP = Boolean(this._casterLightPass || this._screenPass);
        // caster light pass is always first if it exists, hence it uses normal blending
        if (this._casterLightPass) {
            this._casterLightPass.forceSeparateMVP = forceSeparateMVP;
            this._casterLightPass.setBlendMode(BlendMode.NORMAL);
            this._casterLightPass.depthCompareMode = this._material.depthCompareMode;
        }
        if (this._nonCasterLightPasses) {
            var firstAdditiveIndex = 0;
            // if there's no caster light pass, the first non caster light pass will be the first
            // and should use normal blending
            if (!this._casterLightPass) {
                this._nonCasterLightPasses[0].forceSeparateMVP = forceSeparateMVP;
                this._nonCasterLightPasses[0].setBlendMode(BlendMode.NORMAL);
                this._nonCasterLightPasses[0].depthCompareMode = this._material.depthCompareMode;
                firstAdditiveIndex = 1;
            }
            for (var i = firstAdditiveIndex; i < this._nonCasterLightPasses.length; ++i) {
                this._nonCasterLightPasses[i].forceSeparateMVP = forceSeparateMVP;
                this._nonCasterLightPasses[i].setBlendMode(BlendMode.ADD);
                this._nonCasterLightPasses[i].depthCompareMode = ContextGLCompareMode.LESS_EQUAL;
            }
        }
        if (this._casterLightPass || this._nonCasterLightPasses) {
            //cannot be blended by blendmode property if multipass enabled
            this._pRequiresBlending = false;
            // there are light passes, so this should be blended in
            if (this._screenPass) {
                this._screenPass.mode = MethodPassMode.EFFECTS;
                this._screenPass.depthCompareMode = ContextGLCompareMode.LESS_EQUAL;
                this._screenPass.setBlendMode(BlendMode.LAYER);
                this._screenPass.forceSeparateMVP = forceSeparateMVP;
            }
        }
        else if (this._screenPass) {
            this._pRequiresBlending = (this._material.blendMode != BlendMode.NORMAL || this._material.alphaBlending || (this._material.colorTransform && this._material.colorTransform.alphaMultiplier < 1));
            // effects pass is the only pass, so it should just blend normally
            this._screenPass.mode = MethodPassMode.SUPER_SHADER;
            this._screenPass.depthCompareMode = this._material.depthCompareMode;
            this._screenPass.preserveAlpha = this._pRequiresBlending;
            this._screenPass.colorTransform = this._material.colorTransform;
            this._screenPass.setBlendMode((this._material.blendMode == BlendMode.NORMAL && this._pRequiresBlending) ? BlendMode.LAYER : this._material.blendMode);
            this._screenPass.forceSeparateMVP = false;
        }
    };
    RenderMethodMaterialObject.prototype.initCasterLightPass = function () {
        if (this._casterLightPass == null)
            this._casterLightPass = new MethodPass(MethodPassMode.LIGHTING, this, this._material, this._renderableClass, this._stage);
        this._casterLightPass.lightPicker = new StaticLightPicker([this._material.shadowMethod.castingLight]);
        this._casterLightPass.shadowMethod = this._material.shadowMethod;
        this._casterLightPass.diffuseMethod = this._material.diffuseMethod;
        this._casterLightPass.ambientMethod = this._material.ambientMethod;
        this._casterLightPass.normalMethod = this._material.normalMethod;
        this._casterLightPass.specularMethod = this._material.specularMethod;
    };
    RenderMethodMaterialObject.prototype.removeCasterLightPass = function () {
        this._casterLightPass.dispose();
        this._pRemoveScreenPass(this._casterLightPass);
        this._casterLightPass = null;
    };
    RenderMethodMaterialObject.prototype.initNonCasterLightPasses = function () {
        this.removeNonCasterLightPasses();
        var pass;
        var numDirLights = this._material.lightPicker.numDirectionalLights;
        var numPointLights = this._material.lightPicker.numPointLights;
        var numLightProbes = this._material.lightPicker.numLightProbes;
        var dirLightOffset = 0;
        var pointLightOffset = 0;
        var probeOffset = 0;
        if (!this._casterLightPass) {
            numDirLights += this._material.lightPicker.numCastingDirectionalLights;
            numPointLights += this._material.lightPicker.numCastingPointLights;
        }
        this._nonCasterLightPasses = new Array();
        while (dirLightOffset < numDirLights || pointLightOffset < numPointLights || probeOffset < numLightProbes) {
            pass = new MethodPass(MethodPassMode.LIGHTING, this, this._material, this._renderableClass, this._stage);
            pass.includeCasters = this._material.shadowMethod == null;
            pass.directionalLightsOffset = dirLightOffset;
            pass.pointLightsOffset = pointLightOffset;
            pass.lightProbesOffset = probeOffset;
            pass.lightPicker = this._material.lightPicker;
            pass.diffuseMethod = this._material.diffuseMethod;
            pass.ambientMethod = this._material.ambientMethod;
            pass.normalMethod = this._material.normalMethod;
            pass.specularMethod = this._material.specularMethod;
            this._nonCasterLightPasses.push(pass);
            dirLightOffset += pass.numDirectionalLights;
            pointLightOffset += pass.numPointLights;
            probeOffset += pass.numLightProbes;
        }
    };
    RenderMethodMaterialObject.prototype.removeNonCasterLightPasses = function () {
        if (!this._nonCasterLightPasses)
            return;
        for (var i = 0; i < this._nonCasterLightPasses.length; ++i)
            this._pRemoveScreenPass(this._nonCasterLightPasses[i]);
        this._nonCasterLightPasses = null;
    };
    RenderMethodMaterialObject.prototype.removeEffectPass = function () {
        if (this._screenPass.ambientMethod != this._material.ambientMethod)
            this._screenPass.ambientMethod.dispose();
        if (this._screenPass.diffuseMethod != this._material.diffuseMethod)
            this._screenPass.diffuseMethod.dispose();
        if (this._screenPass.specularMethod != this._material.specularMethod)
            this._screenPass.specularMethod.dispose();
        if (this._screenPass.normalMethod != this._material.normalMethod)
            this._screenPass.normalMethod.dispose();
        this._pRemoveScreenPass(this._screenPass);
        this._screenPass = null;
    };
    RenderMethodMaterialObject.prototype.initEffectPass = function () {
        if (this._screenPass == null)
            this._screenPass = new MethodPass(MethodPassMode.SUPER_SHADER, this, this._material, this._renderableClass, this._stage);
        if (this._material.mode == MethodMaterialMode.SINGLE_PASS) {
            this._screenPass.ambientMethod = this._material.ambientMethod;
            this._screenPass.diffuseMethod = this._material.diffuseMethod;
            this._screenPass.specularMethod = this._material.specularMethod;
            this._screenPass.normalMethod = this._material.normalMethod;
            this._screenPass.shadowMethod = this._material.shadowMethod;
        }
        else if (this._material.mode == MethodMaterialMode.MULTI_PASS) {
            if (this.numLights == 0) {
                this._screenPass.ambientMethod = this._material.ambientMethod;
            }
            else {
                this._screenPass.ambientMethod = null;
            }
            this._screenPass.preserveAlpha = false;
            this._screenPass.normalMethod = this._material.normalMethod;
        }
        //update effect methods
        var i = 0;
        var effectMethod;
        var len = Math.max(this._material.numEffectMethods, this._screenPass.numEffectMethods);
        while (i < len) {
            effectMethod = this._material.getEffectMethodAt(i);
            if (effectMethod != this._screenPass.getEffectMethodAt(i)) {
                this._screenPass.removeEffectMethodAt(i);
                if (effectMethod != null) {
                    if (i < this._screenPass.numEffectMethods)
                        this._screenPass.addEffectMethodAt(effectMethod, i);
                    else
                        this._screenPass.addEffectMethod(effectMethod);
                }
            }
            i++;
        }
    };
    /**
     * @inheritDoc
     */
    RenderMethodMaterialObject.prototype.dispose = function () {
        _super.prototype.dispose.call(this);
        //TODO
    };
    /**
     *
     */
    RenderMethodMaterialObject.id = "method";
    return RenderMethodMaterialObject;
})(RenderObjectBase);
module.exports = RenderMethodMaterialObject;

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF3YXlqcy1tZXRob2RtYXRlcmlhbHMvbGliL2NvbXBpbGF0aW9uL1JlbmRlck1ldGhvZE1hdGVyaWFsT2JqZWN0LnRzIl0sIm5hbWVzIjpbIlJlbmRlck1ldGhvZE1hdGVyaWFsT2JqZWN0IiwiUmVuZGVyTWV0aG9kTWF0ZXJpYWxPYmplY3QuY29uc3RydWN0b3IiLCJSZW5kZXJNZXRob2RNYXRlcmlhbE9iamVjdC5udW1MaWdodHMiLCJSZW5kZXJNZXRob2RNYXRlcmlhbE9iamVjdC5udW1Ob25DYXN0ZXJzIiwiUmVuZGVyTWV0aG9kTWF0ZXJpYWxPYmplY3QuX3BVcGRhdGVSZW5kZXJPYmplY3QiLCJSZW5kZXJNZXRob2RNYXRlcmlhbE9iamVjdC5pbml0UGFzc2VzIiwiUmVuZGVyTWV0aG9kTWF0ZXJpYWxPYmplY3Quc2V0QmxlbmRBbmRDb21wYXJlTW9kZXMiLCJSZW5kZXJNZXRob2RNYXRlcmlhbE9iamVjdC5pbml0Q2FzdGVyTGlnaHRQYXNzIiwiUmVuZGVyTWV0aG9kTWF0ZXJpYWxPYmplY3QucmVtb3ZlQ2FzdGVyTGlnaHRQYXNzIiwiUmVuZGVyTWV0aG9kTWF0ZXJpYWxPYmplY3QuaW5pdE5vbkNhc3RlckxpZ2h0UGFzc2VzIiwiUmVuZGVyTWV0aG9kTWF0ZXJpYWxPYmplY3QucmVtb3ZlTm9uQ2FzdGVyTGlnaHRQYXNzZXMiLCJSZW5kZXJNZXRob2RNYXRlcmlhbE9iamVjdC5yZW1vdmVFZmZlY3RQYXNzIiwiUmVuZGVyTWV0aG9kTWF0ZXJpYWxPYmplY3QuaW5pdEVmZmVjdFBhc3MiLCJSZW5kZXJNZXRob2RNYXRlcmlhbE9iamVjdC5kaXNwb3NlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFRQSxJQUFPLFNBQVMsV0FBZ0IsbUNBQW1DLENBQUMsQ0FBQztBQUlyRSxJQUFPLGlCQUFpQixXQUFjLDZEQUE2RCxDQUFDLENBQUM7QUFHckcsSUFBTyxvQkFBb0IsV0FBYyw4Q0FBOEMsQ0FBQyxDQUFDO0FBTXpGLElBQU8sZ0JBQWdCLFdBQWUsb0RB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QSxDQUFDQSxTQUFTQSxDQUFDQSxhQUFhQSxDQUFDQTtZQUM5REEsSUFBSUEsQ0FBQ0EsV0FBV0EsQ0FBQ0EsYUFBYUEsR0FBR0EsSUFBSUEsQ0FBQ0EsU0FBU0EsQ0FBQ0EsYUFBYUEsQ0FBQ0E7WUFDOURBLElBQUlBLENBQUNBLFdBQVdBLENBQUNBLGNBQWNBLEdBQUdBLElBQUlBLENBQUNBLFNBQVNBLENBQUNBLGNBQWNBLENBQUNBO1lBQ2hFQSxJQUFJQSxDQUFDQSxXQUFXQSxDQUFDQSxZQUFZQSxHQUFHQSxJQUFJQSxDQUFDQSxTQUFTQSxDQUFDQSxZQUFZQSxDQUFDQTtZQUM1REEsSUFBSUEsQ0FBQ0EsV0FBV0EsQ0FBQ0EsWUFBWUEsR0FBR0EsSUFBSUEsQ0FBQ0EsU0FBU0EsQ0FBQ0EsWUFBWUEsQ0FBQ0E7UUFDN0RBLENBQUNBO1FBQUNBLElBQUlBLENBQUNBLEVBQUVBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLFNBQVNBLENBQUNBLElBQUlBLElBQUlBLGtCQUFrQkEsQ0FBQ0EsVUFBVUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFDakVBLEVBQUVBLENBQUNBLENBQUNBLElBQUlBLENBQUNBLFNBQVNBLElBQUlBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO2dCQUN6QkEsSUFBSUEsQ0FBQ0EsV0FBV0EsQ0FBQ0EsYUFBYUEsR0FBR0EsSUFBSUEsQ0FBQ0EsU0FBU0EsQ0FBQ0EsYUFBYUEsQ0FBQ0E7WUFDL0RBLENBQUNBO1lBQUNBLElBQUlBLENBQUNBLENBQUNBO2dCQUNQQSxJQUFJQSxDQUFDQSxXQUFXQSxDQUFDQSxhQUFhQSxHQUFHQSxJQUFJQSxDQUFDQTtZQUN2Q0EsQ0FBQ0E7WUFFREEsSUFBSUEsQ0FBQ0EsV0FBV0EsQ0FBQ0EsYUFBYUEsR0FBR0EsS0FBS0EsQ0FBQ0E7WUFDdkNBLElBQUlBLENBQUNBLFdBQVdBLENBQUNBLFlBQVlBLEdBQUdBLElBQUlBLENBQUNBLFNBQVNBLENBQUNBLFlBQVlBLENBQUNBO1FBQzdEQSxDQUFDQTtRQUVEQSxBQUNBQSx1QkFEdUJBO1lBQ25CQSxDQUFDQSxHQUFVQSxDQUFDQSxDQUFDQTtRQUNqQkEsSUFBSUEsWUFBNkJBLENBQUNBO1FBQ2xDQSxJQUFJQSxHQUFHQSxHQUFVQSxJQUFJQSxDQUFDQSxHQUFHQSxDQUFDQSxJQUFJQSxDQUFDQSxTQUFTQSxDQUFDQSxnQkFBZ0JBLEVBQUVBLElBQUlBLENBQUNBLFdBQVdBLENBQUNBLGdCQUFnQkEsQ0FBQ0EsQ0FBQ0E7UUFFOUZBLE9BQU9BLENBQUNBLEdBQUdBLEdBQUdBLEVBQUVBLENBQUNBO1lBQ2hCQSxZQUFZQSxHQUFHQSxJQUFJQSxDQUFDQSxTQUFTQSxDQUFDQSxpQkFBaUJBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO1lBQ25EQSxFQUFFQSxDQUFDQSxDQUFDQSxZQUFZQSxJQUFJQSxJQUFJQSxDQUFDQSxXQUFXQSxDQUFDQSxpQkFBaUJBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLENBQUNBLENBQUNBO2dCQUMzREEsSUFBSUEsQ0FBQ0EsV0FBV0EsQ0FBQ0Esb0JBQW9CQSxDQUFDQSxDQUFDQSxDQUFDQSxDQUFDQTtnQkFFekNBLEVBQUVBLENBQUNBLENBQUNBLFlBQVlBLElBQUlBLElBQUlBLENBQUNBLENBQUNBLENBQUNBO29CQUMxQkEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0EsR0FBR0EsSUFBSUEsQ0FBQ0EsV0FBV0EsQ0FBQ0EsZ0JBQWdCQSxDQUFDQTt3QkFDekNBLElBQUlBLENBQUNBLFdBQVdBLENBQUNBLGlCQUFpQkEsQ0FBQ0EsWUFBWUEsRUFBRUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7b0JBQ3JEQSxJQUFJQTt3QkFDSEEsSUFBSUEsQ0FBQ0EsV0FBV0EsQ0FBQ0EsZUFBZUEsQ0FBQ0EsWUFBWUEsQ0FBQ0EsQ0FBQ0E7Z0JBQ2pEQSxDQUFDQTtZQUNGQSxDQUFDQTtZQUVEQSxDQUFDQSxFQUFFQSxDQUFDQTtRQUNMQSxDQUFDQTtJQUNGQSxDQUFDQTtJQUVEWjs7T0FFR0E7SUFDSUEsNENBQU9BLEdBQWRBO1FBRUNhLGdCQUFLQSxDQUFDQSxPQUFPQSxXQUFFQSxDQUFDQTtRQUVoQkEsTUFBTUE7SUFDUEEsQ0FBQ0E7SUE5UkRiOztPQUVHQTtJQUNXQSw2QkFBRUEsR0FBVUEsUUFBUUEsQ0FBQ0E7SUE0UnBDQSxpQ0FBQ0E7QUFBREEsQ0FqU0EsQUFpU0NBLEVBalN3QyxnQkFBZ0IsRUFpU3hEO0FBRUQsQUFBb0MsaUJBQTNCLDBCQUEwQixDQUFDIiwiZmlsZSI6ImNvbXBpbGF0aW9uL1JlbmRlck1ldGhvZE1hdGVyaWFsT2JqZWN0LmpzIiwic291cmNlUm9vdCI6Ii4uLyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBDb2xvclRyYW5zZm9ybVx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvZ2VvbS9Db2xvclRyYW5zZm9ybVwiKTtcbmltcG9ydCBNYXRyaXhcdFx0XHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi9nZW9tL01hdHJpeFwiKTtcbmltcG9ydCBNYXRyaXgzRFx0XHRcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL2dlb20vTWF0cml4M0RcIik7XG5pbXBvcnQgTWF0cml4M0RVdGlsc1x0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvZ2VvbS9NYXRyaXgzRFV0aWxzXCIpO1xuaW1wb3J0IFZlY3RvcjNEXHRcdFx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvZ2VvbS9WZWN0b3IzRFwiKTtcbmltcG9ydCBBYnN0cmFjdE1ldGhvZEVycm9yXHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvZXJyb3JzL0Fic3RyYWN0TWV0aG9kRXJyb3JcIik7XG5pbXBvcnQgVGV4dHVyZTJEQmFzZVx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvdGV4dHVyZXMvVGV4dHVyZTJEQmFzZVwiKTtcblxuaW1wb3J0IEJsZW5kTW9kZVx0XHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1kaXNwbGF5L2xpYi9iYXNlL0JsZW5kTW9kZVwiKTtcbmltcG9ydCBUcmlhbmdsZVN1Ykdlb21ldHJ5XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtZGlzcGxheS9saWIvYmFzZS9UcmlhbmdsZVN1Ykdlb21ldHJ5XCIpO1xuaW1wb3J0IENhbWVyYVx0XHRcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWRpc3BsYXkvbGliL2VudGl0aWVzL0NhbWVyYVwiKTtcbmltcG9ydCBJUmVuZGVyT2JqZWN0T3duZXJcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1kaXNwbGF5L2xpYi9iYXNlL0lSZW5kZXJPYmplY3RPd25lclwiKTtcbmltcG9ydCBTdGF0aWNMaWdodFBpY2tlclx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWRpc3BsYXkvbGliL21hdGVyaWFscy9saWdodHBpY2tlcnMvU3RhdGljTGlnaHRQaWNrZXJcIik7XG5cbmltcG9ydCBTdGFnZVx0XHRcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXN0YWdlZ2wvbGliL2Jhc2UvU3RhZ2VcIik7XG5pbXBvcnQgQ29udGV4dEdMQ29tcGFyZU1vZGVcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1zdGFnZWdsL2xpYi9iYXNlL0NvbnRleHRHTENvbXBhcmVNb2RlXCIpO1xuXG5pbXBvcnQgUmVuZGVyZXJCYXNlXHRcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXJlbmRlcmVyZ2wvbGliL2Jhc2UvUmVuZGVyZXJCYXNlXCIpO1xuaW1wb3J0IFJlbmRlck9iamVjdFBvb2xcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXJlbmRlcmVyZ2wvbGliL2NvbXBpbGF0aW9uL1JlbmRlck9iamVjdFBvb2xcIik7XG5pbXBvcnQgU2hhZGluZ01ldGhvZEV2ZW50XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtcmVuZGVyZXJnbC9saWIvZXZlbnRzL1NoYWRpbmdNZXRob2RFdmVudFwiKTtcbmltcG9ydCBTaGFkZXJPYmplY3RCYXNlXHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1yZW5kZXJlcmdsL2xpYi9jb21waWxhdGlvbi9TaGFkZXJPYmplY3RCYXNlXCIpO1xuaW1wb3J0IFJlbmRlck9iamVjdEJhc2VcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXJlbmRlcmVyZ2wvbGliL2NvbXBpbGF0aW9uL1JlbmRlck9iamVjdEJhc2VcIik7XG5pbXBvcnQgUmVuZGVyYWJsZUJhc2VcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLXJlbmRlcmVyZ2wvbGliL3Bvb2wvUmVuZGVyYWJsZUJhc2VcIik7XG5pbXBvcnQgSVJlbmRlcmFibGVDbGFzc1x0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtcmVuZGVyZXJnbC9saWIvcG9vbC9JUmVuZGVyYWJsZUNsYXNzXCIpO1xuXG5pbXBvcnQgTWV0aG9kTWF0ZXJpYWxcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLW1ldGhvZG1hdGVyaWFscy9saWIvTWV0aG9kTWF0ZXJpYWxcIik7XG5pbXBvcnQgTWV0aG9kUGFzc01vZGVcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLW1ldGhvZG1hdGVyaWFscy9saWIvcGFzc2VzL01ldGhvZFBhc3NNb2RlXCIpO1xuaW1wb3J0IE1ldGhvZFBhc3NcdFx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtbWV0aG9kbWF0ZXJpYWxzL2xpYi9wYXNzZXMvTWV0aG9kUGFzc1wiKTtcbmltcG9ydCBBbWJpZW50QmFzaWNNZXRob2RcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1tZXRob2RtYXRlcmlhbHMvbGliL21ldGhvZHMvQW1iaWVudEJhc2ljTWV0aG9kXCIpO1xuaW1wb3J0IERpZmZ1c2VCYXNpY01ldGhvZFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLW1ldGhvZG1hdGVyaWFscy9saWIvbWV0aG9kcy9EaWZmdXNlQmFzaWNNZXRob2RcIik7XG5pbXBvcnQgRWZmZWN0Q29sb3JUcmFuc2Zvcm1NZXRob2RcdFx0PSByZXF1aXJlKFwiYXdheWpzLW1ldGhvZG1hdGVyaWFscy9saWIvbWV0aG9kcy9FZmZlY3RDb2xvclRyYW5zZm9ybU1ldGhvZFwiKTtcbmltcG9ydCBFZmZlY3RNZXRob2RCYXNlXHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1tZXRob2RtYXRlcmlhbHMvbGliL21ldGhvZHMvRWZmZWN0TWV0aG9kQmFzZVwiKTtcbmltcG9ydCBMaWdodGluZ01ldGhvZEJhc2VcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1tZXRob2RtYXRlcmlhbHMvbGliL21ldGhvZHMvTGlnaHRpbmdNZXRob2RCYXNlXCIpO1xuaW1wb3J0IE5vcm1hbEJhc2ljTWV0aG9kXHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtbWV0aG9kbWF0ZXJpYWxzL2xpYi9tZXRob2RzL05vcm1hbEJhc2ljTWV0aG9kXCIpO1xuaW1wb3J0IFNoYWRvd01hcE1ldGhvZEJhc2VcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1tZXRob2RtYXRlcmlhbHMvbGliL21ldGhvZHMvU2hhZG93TWFwTWV0aG9kQmFzZVwiKTtcbmltcG9ydCBTcGVjdWxhckJhc2ljTWV0aG9kXHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtbWV0aG9kbWF0ZXJpYWxzL2xpYi9tZXRob2RzL1NwZWN1bGFyQmFzaWNNZXRob2RcIik7XG5pbXBvcnQgTWV0aG9kTWF0ZXJpYWxNb2RlXHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtbWV0aG9kbWF0ZXJpYWxzL2xpYi9NZXRob2RNYXRlcmlhbE1vZGVcIik7XG5cbi8qKlxuICogQ29tcGlsZWRQYXNzIGZvcm1zIGFuIGFic3RyYWN0IGJhc2UgY2xhc3MgZm9yIHRoZSBkZWZhdWx0IGNvbXBpbGVkIHBhc3MgbWF0ZXJpYWxzIHByb3ZpZGVkIGJ5IEF3YXkzRCxcbiAqIHVzaW5nIG1hdGVyaWFsIG1ldGhvZHMgdG8gZGVmaW5lIHRoZWlyIGFwcGVhcmFuY2UuXG4gKi9cbmNsYXNzIFJlbmRlck1ldGhvZE1hdGVyaWFsT2JqZWN0IGV4dGVuZHMgUmVuZGVyT2JqZWN0QmFzZVxue1xuXHQvKipcblx0ICpcblx0ICovXG5cdHB1YmxpYyBzdGF0aWMgaWQ6c3RyaW5nID0gXCJtZXRob2RcIjtcblxuXHRwcml2YXRlIF9tYXRlcmlhbDpNZXRob2RNYXRlcmlhbDtcblx0cHJpdmF0ZSBfc2NyZWVuUGFzczpNZXRob2RQYXNzO1xuXHRwcml2YXRlIF9jYXN0ZXJMaWdodFBhc3M6TWV0aG9kUGFzcztcblx0cHJpdmF0ZSBfbm9uQ2FzdGVyTGlnaHRQYXNzZXM6QXJyYXk8TWV0aG9kUGFzcz47XG5cdFxuXHQvKipcblx0ICogVGhlIG1heGltdW0gdG90YWwgbnVtYmVyIG9mIGxpZ2h0cyBwcm92aWRlZCBieSB0aGUgbGlnaHQgcGlja2VyLlxuXHQgKi9cblx0cHJpdmF0ZSBnZXQgbnVtTGlnaHRzKCk6bnVtYmVyXG5cdHtcblx0XHRyZXR1cm4gdGhpcy5fbWF0ZXJpYWwubGlnaHRQaWNrZXI/IHRoaXMuX21hdGVyaWFsLmxpZ2h0UGlja2VyLm51bUxpZ2h0UHJvYmVzICsgdGhpcy5fbWF0ZXJpYWwubGlnaHRQaWNrZXIubnVtRGlyZWN0aW9uYWxMaWdodHMgKyB0aGlzLl9tYXRlcmlhbC5saWdodFBpY2tlci5udW1Qb2ludExpZ2h0cyArIHRoaXMuX21hdGVyaWFsLmxpZ2h0UGlja2VyLm51bUNhc3RpbmdEaXJlY3Rpb25hbExpZ2h0cyArIHRoaXMuX21hdGVyaWFsLmxpZ2h0UGlja2VyLm51bUNhc3RpbmdQb2ludExpZ2h0cyA6IDA7XG5cdH1cblxuXHQvKipcblx0ICogVGhlIGFtb3VudCBvZiBsaWdodHMgdGhhdCBkb24ndCBjYXN0IHNoYWRvd3MuXG5cdCAqL1xuXHRwcml2YXRlIGdldCBudW1Ob25DYXN0ZXJzKCk6bnVtYmVyXG5cdHtcblx0XHRyZXR1cm4gdGhpcy5fbWF0ZXJpYWwubGlnaHRQaWNrZXI/IHRoaXMuX21hdGVyaWFsLmxpZ2h0UGlja2VyLm51bUxpZ2h0UHJvYmVzICsgdGhpcy5fbWF0ZXJpYWwubGlnaHRQaWNrZXIubnVtRGlyZWN0aW9uYWxMaWdodHMgKyB0aGlzLl9tYXRlcmlhbC5saWdodFBpY2tlci5udW1Qb2ludExpZ2h0cyA6IDA7XG5cdH1cblxuXHQvKipcblx0ICogQ3JlYXRlcyBhIG5ldyBDb21waWxlZFBhc3Mgb2JqZWN0LlxuXHQgKlxuXHQgKiBAcGFyYW0gbWF0ZXJpYWwgVGhlIG1hdGVyaWFsIHRvIHdoaWNoIHRoaXMgcGFzcyBiZWxvbmdzLlxuXHQgKi9cblx0Y29uc3RydWN0b3IocG9vbDpSZW5kZXJPYmplY3RQb29sLCBtYXRlcmlhbDpNZXRob2RNYXRlcmlhbCwgcmVuZGVyYWJsZUNsYXNzOklSZW5kZXJhYmxlQ2xhc3MsIHN0YWdlOlN0YWdlKVxuXHR7XG5cdFx0c3VwZXIocG9vbCwgbWF0ZXJpYWwsIHJlbmRlcmFibGVDbGFzcywgc3RhZ2UpO1xuXG5cdFx0dGhpcy5fbWF0ZXJpYWwgPSBtYXRlcmlhbDtcblx0fVxuXG5cdC8qKlxuXHQgKiBAaW5oZXJpdERvY1xuXHQgKi9cblx0cHVibGljIF9wVXBkYXRlUmVuZGVyT2JqZWN0KClcblx0e1xuXHRcdHN1cGVyLl9wVXBkYXRlUmVuZGVyT2JqZWN0KCk7XG5cblx0XHR0aGlzLmluaXRQYXNzZXMoKTtcblxuXHRcdHRoaXMuc2V0QmxlbmRBbmRDb21wYXJlTW9kZXMoKTtcblxuXHRcdHRoaXMuX3BDbGVhclNjcmVlblBhc3NlcygpO1xuXG5cdFx0aWYgKHRoaXMuX21hdGVyaWFsLm1vZGUgPT0gTWV0aG9kTWF0ZXJpYWxNb2RlLk1VTFRJX1BBU1MpIHtcblx0XHRcdGlmICh0aGlzLl9jYXN0ZXJMaWdodFBhc3MpXG5cdFx0XHRcdHRoaXMuX3BBZGRTY3JlZW5QYXNzKHRoaXMuX2Nhc3RlckxpZ2h0UGFzcyk7XG5cblx0XHRcdGlmICh0aGlzLl9ub25DYXN0ZXJMaWdodFBhc3Nlcylcblx0XHRcdFx0Zm9yICh2YXIgaTpudW1iZXIgPSAwOyBpIDwgdGhpcy5fbm9uQ2FzdGVyTGlnaHRQYXNzZXMubGVuZ3RoOyArK2kpXG5cdFx0XHRcdFx0dGhpcy5fcEFkZFNjcmVlblBhc3ModGhpcy5fbm9uQ2FzdGVyTGlnaHRQYXNzZXNbaV0pO1xuXHRcdH1cblxuXHRcdGlmICh0aGlzLl9zY3JlZW5QYXNzKVxuXHRcdFx0dGhpcy5fcEFkZFNjcmVlblBhc3ModGhpcy5fc2NyZWVuUGFzcyk7XG5cdH1cblxuXHQvKipcblx0ICogSW5pdGlhbGl6ZXMgYWxsIHRoZSBwYXNzZXMgYW5kIHRoZWlyIGRlcGVuZGVudCBwYXNzZXMuXG5cdCAqL1xuXHRwcml2YXRlIGluaXRQYXNzZXMoKVxuXHR7XG5cdFx0Ly8gbGV0IHRoZSBlZmZlY3RzIHBhc3MgaGFuZGxlIGV2ZXJ5dGhpbmcgaWYgdGhlcmUgYXJlIG5vIGxpZ2h0cywgd2hlbiB0aGVyZSBhcmUgZWZmZWN0IG1ldGhvZHMgYXBwbGllZFxuXHRcdC8vIGFmdGVyIHNoYWRpbmcsIG9yIHdoZW4gdGhlIG1hdGVyaWFsIG1vZGUgaXMgc2luZ2xlIHBhc3MuXG5cdFx0aWYgKHRoaXMubnVtTGlnaHRzID09IDAgfHwgdGhpcy5fbWF0ZXJpYWwubnVtRWZmZWN0TWV0aG9kcyA+IDAgfHwgdGhpcy5fbWF0ZXJpYWwubW9kZSA9PSBNZXRob2RNYXRlcmlhbE1vZGUuU0lOR0xFX1BBU1MpXG5cdFx0XHR0aGlzLmluaXRFZmZlY3RQYXNzKCk7XG5cdFx0ZWxzZSBpZiAodGhpcy5fc2NyZWVuUGFzcylcblx0XHRcdHRoaXMucmVtb3ZlRWZmZWN0UGFzcygpO1xuXG5cdFx0Ly8gb25seSB1c2UgYSBjYXN0ZXIgbGlnaHQgcGFzcyBpZiBzaGFkb3dzIG5lZWQgdG8gYmUgcmVuZGVyZWRcblx0XHRpZiAodGhpcy5fbWF0ZXJpYWwuc2hhZG93TWV0aG9kICYmIHRoaXMuX21hdGVyaWFsLm1vZGUgPT0gTWV0aG9kTWF0ZXJpYWxNb2RlLk1VTFRJX1BBU1MpXG5cdFx0XHR0aGlzLmluaXRDYXN0ZXJMaWdodFBhc3MoKTtcblx0XHRlbHNlIGlmICh0aGlzLl9jYXN0ZXJMaWdodFBhc3MpXG5cdFx0XHR0aGlzLnJlbW92ZUNhc3RlckxpZ2h0UGFzcygpO1xuXG5cdFx0Ly8gb25seSB1c2Ugbm9uIGNhc3RlciBsaWdodCBwYXNzZXMgaWYgdGhlcmUgYXJlIGxpZ2h0cyB0aGF0IGRvbid0IGNhc3Rcblx0XHRpZiAodGhpcy5udW1Ob25DYXN0ZXJzID4gMCAmJiB0aGlzLl9tYXRlcmlhbC5tb2RlID09IE1ldGhvZE1hdGVyaWFsTW9kZS5NVUxUSV9QQVNTKVxuXHRcdFx0dGhpcy5pbml0Tm9uQ2FzdGVyTGlnaHRQYXNzZXMoKTtcblx0XHRlbHNlIGlmICh0aGlzLl9ub25DYXN0ZXJMaWdodFBhc3Nlcylcblx0XHRcdHRoaXMucmVtb3ZlTm9uQ2FzdGVyTGlnaHRQYXNzZXMoKTtcblx0fVxuXG5cdC8qKlxuXHQgKiBTZXRzIHVwIHRoZSB2YXJpb3VzIGJsZW5kaW5nIG1vZGVzIGZvciBhbGwgc2NyZWVuIHBhc3NlcywgYmFzZWQgb24gd2hldGhlciBvciBub3QgdGhlcmUgYXJlIHByZXZpb3VzIHBhc3Nlcy5cblx0ICovXG5cdHByaXZhdGUgc2V0QmxlbmRBbmRDb21wYXJlTW9kZXMoKVxuXHR7XG5cdFx0dmFyIGZvcmNlU2VwYXJhdGVNVlA6Ym9vbGVhbiA9IEJvb2xlYW4odGhpcy5fY2FzdGVyTGlnaHRQYXNzIHx8IHRoaXMuX3NjcmVlblBhc3MpO1xuXG5cdFx0Ly8gY2FzdGVyIGxpZ2h0IHBhc3MgaXMgYWx3YXlzIGZpcnN0IGlmIGl0IGV4aXN0cywgaGVuY2UgaXQgdXNlcyBub3JtYWwgYmxlbmRpbmdcblx0XHRpZiAodGhpcy5fY2FzdGVyTGlnaHRQYXNzKSB7XG5cdFx0XHR0aGlzLl9jYXN0ZXJMaWdodFBhc3MuZm9yY2VTZXBhcmF0ZU1WUCA9IGZvcmNlU2VwYXJhdGVNVlA7XG5cdFx0XHR0aGlzLl9jYXN0ZXJMaWdodFBhc3Muc2V0QmxlbmRNb2RlKEJsZW5kTW9kZS5OT1JNQUwpO1xuXHRcdFx0dGhpcy5fY2FzdGVyTGlnaHRQYXNzLmRlcHRoQ29tcGFyZU1vZGUgPSB0aGlzLl9tYXRlcmlhbC5kZXB0aENvbXBhcmVNb2RlO1xuXHRcdH1cblxuXHRcdGlmICh0aGlzLl9ub25DYXN0ZXJMaWdodFBhc3Nlcykge1xuXHRcdFx0dmFyIGZpcnN0QWRkaXRpdmVJbmRleDpudW1iZXIgPSAwO1xuXG5cdFx0XHQvLyBpZiB0aGVyZSdzIG5vIGNhc3RlciBsaWdodCBwYXNzLCB0aGUgZmlyc3Qgbm9uIGNhc3RlciBsaWdodCBwYXNzIHdpbGwgYmUgdGhlIGZpcnN0XG5cdFx0XHQvLyBhbmQgc2hvdWxkIHVzZSBub3JtYWwgYmxlbmRpbmdcblx0XHRcdGlmICghdGhpcy5fY2FzdGVyTGlnaHRQYXNzKSB7XG5cdFx0XHRcdHRoaXMuX25vbkNhc3RlckxpZ2h0UGFzc2VzWzBdLmZvcmNlU2VwYXJhdGVNVlAgPSBmb3JjZVNlcGFyYXRlTVZQO1xuXHRcdFx0XHR0aGlzLl9ub25DYXN0ZXJMaWdodFBhc3Nlc1swXS5zZXRCbGVuZE1vZGUoQmxlbmRNb2RlLk5PUk1BTCk7XG5cdFx0XHRcdHRoaXMuX25vbkNhc3RlckxpZ2h0UGFzc2VzWzBdLmRlcHRoQ29tcGFyZU1vZGUgPSB0aGlzLl9tYXRlcmlhbC5kZXB0aENvbXBhcmVNb2RlO1xuXHRcdFx0XHRmaXJzdEFkZGl0aXZlSW5kZXggPSAxO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBhbGwgbGlnaHRpbmcgcGFzc2VzIGZvbGxvd2luZyB0aGUgZmlyc3QgbGlnaHQgcGFzcyBzaG91bGQgdXNlIGFkZGl0aXZlIGJsZW5kaW5nXG5cdFx0XHRmb3IgKHZhciBpOm51bWJlciA9IGZpcnN0QWRkaXRpdmVJbmRleDsgaSA8IHRoaXMuX25vbkNhc3RlckxpZ2h0UGFzc2VzLmxlbmd0aDsgKytpKSB7XG5cdFx0XHRcdHRoaXMuX25vbkNhc3RlckxpZ2h0UGFzc2VzW2ldLmZvcmNlU2VwYXJhdGVNVlAgPSBmb3JjZVNlcGFyYXRlTVZQO1xuXHRcdFx0XHR0aGlzLl9ub25DYXN0ZXJMaWdodFBhc3Nlc1tpXS5zZXRCbGVuZE1vZGUoQmxlbmRNb2RlLkFERCk7XG5cdFx0XHRcdHRoaXMuX25vbkNhc3RlckxpZ2h0UGFzc2VzW2ldLmRlcHRoQ29tcGFyZU1vZGUgPSBDb250ZXh0R0xDb21wYXJlTW9kZS5MRVNTX0VRVUFMO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGlmICh0aGlzLl9jYXN0ZXJMaWdodFBhc3MgfHwgdGhpcy5fbm9uQ2FzdGVyTGlnaHRQYXNzZXMpIHtcblx0XHRcdC8vY2Fubm90IGJlIGJsZW5kZWQgYnkgYmxlbmRtb2RlIHByb3BlcnR5IGlmIG11bHRpcGFzcyBlbmFibGVkXG5cdFx0XHR0aGlzLl9wUmVxdWlyZXNCbGVuZGluZyA9IGZhbHNlO1xuXG5cdFx0XHQvLyB0aGVyZSBhcmUgbGlnaHQgcGFzc2VzLCBzbyB0aGlzIHNob3VsZCBiZSBibGVuZGVkIGluXG5cdFx0XHRpZiAodGhpcy5fc2NyZWVuUGFzcykge1xuXHRcdFx0XHR0aGlzLl9zY3JlZW5QYXNzLm1vZGUgPSBNZXRob2RQYXNzTW9kZS5FRkZFQ1RTO1xuXHRcdFx0XHR0aGlzLl9zY3JlZW5QYXNzLmRlcHRoQ29tcGFyZU1vZGUgPSBDb250ZXh0R0xDb21wYXJlTW9kZS5MRVNTX0VRVUFMO1xuXHRcdFx0XHR0aGlzLl9zY3JlZW5QYXNzLnNldEJsZW5kTW9kZShCbGVuZE1vZGUuTEFZRVIpO1xuXHRcdFx0XHR0aGlzLl9zY3JlZW5QYXNzLmZvcmNlU2VwYXJhdGVNVlAgPSBmb3JjZVNlcGFyYXRlTVZQO1xuXHRcdFx0fVxuXG5cdFx0fSBlbHNlIGlmICh0aGlzLl9zY3JlZW5QYXNzKSB7XG5cdFx0XHR0aGlzLl9wUmVxdWlyZXNCbGVuZGluZyA9ICh0aGlzLl9tYXRlcmlhbC5ibGVuZE1vZGUgIT0gQmxlbmRNb2RlLk5PUk1BTCB8fCB0aGlzLl9tYXRlcmlhbC5hbHBoYUJsZW5kaW5nIHx8ICh0aGlzLl9tYXRlcmlhbC5jb2xvclRyYW5zZm9ybSAmJiB0aGlzLl9tYXRlcmlhbC5jb2xvclRyYW5zZm9ybS5hbHBoYU11bHRpcGxpZXIgPCAxKSk7XG5cdFx0XHQvLyBlZmZlY3RzIHBhc3MgaXMgdGhlIG9ubHkgcGFzcywgc28gaXQgc2hvdWxkIGp1c3QgYmxlbmQgbm9ybWFsbHlcblx0XHRcdHRoaXMuX3NjcmVlblBhc3MubW9kZSA9IE1ldGhvZFBhc3NNb2RlLlNVUEVSX1NIQURFUjtcblx0XHRcdHRoaXMuX3NjcmVlblBhc3MuZGVwdGhDb21wYXJlTW9kZSA9IHRoaXMuX21hdGVyaWFsLmRlcHRoQ29tcGFyZU1vZGU7XG5cdFx0XHR0aGlzLl9zY3JlZW5QYXNzLnByZXNlcnZlQWxwaGEgPSB0aGlzLl9wUmVxdWlyZXNCbGVuZGluZztcblx0XHRcdHRoaXMuX3NjcmVlblBhc3MuY29sb3JUcmFuc2Zvcm0gPSB0aGlzLl9tYXRlcmlhbC5jb2xvclRyYW5zZm9ybTtcblx0XHRcdHRoaXMuX3NjcmVlblBhc3Muc2V0QmxlbmRNb2RlKCh0aGlzLl9tYXRlcmlhbC5ibGVuZE1vZGUgPT0gQmxlbmRNb2RlLk5PUk1BTCAmJiB0aGlzLl9wUmVxdWlyZXNCbGVuZGluZyk/IEJsZW5kTW9kZS5MQVlFUiA6IHRoaXMuX21hdGVyaWFsLmJsZW5kTW9kZSk7XG5cdFx0XHR0aGlzLl9zY3JlZW5QYXNzLmZvcmNlU2VwYXJhdGVNVlAgPSBmYWxzZTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGluaXRDYXN0ZXJMaWdodFBhc3MoKVxuXHR7XG5cblx0XHRpZiAodGhpcy5fY2FzdGVyTGlnaHRQYXNzID09IG51bGwpXG5cdFx0XHR0aGlzLl9jYXN0ZXJMaWdodFBhc3MgPSBuZXcgTWV0aG9kUGFzcyhNZXRob2RQYXNzTW9kZS5MSUdIVElORywgdGhpcywgdGhpcy5fbWF0ZXJpYWwsIHRoaXMuX3JlbmRlcmFibGVDbGFzcywgdGhpcy5fc3RhZ2UpO1xuXG5cdFx0dGhpcy5fY2FzdGVyTGlnaHRQYXNzLmxpZ2h0UGlja2VyID0gbmV3IFN0YXRpY0xpZ2h0UGlja2VyKFt0aGlzLl9tYXRlcmlhbC5zaGFkb3dNZXRob2QuY2FzdGluZ0xpZ2h0XSk7XG5cdFx0dGhpcy5fY2FzdGVyTGlnaHRQYXNzLnNoYWRvd01ldGhvZCA9IHRoaXMuX21hdGVyaWFsLnNoYWRvd01ldGhvZDtcblx0XHR0aGlzLl9jYXN0ZXJMaWdodFBhc3MuZGlmZnVzZU1ldGhvZCA9IHRoaXMuX21hdGVyaWFsLmRpZmZ1c2VNZXRob2Q7XG5cdFx0dGhpcy5fY2FzdGVyTGlnaHRQYXNzLmFtYmllbnRNZXRob2QgPSB0aGlzLl9tYXRlcmlhbC5hbWJpZW50TWV0aG9kO1xuXHRcdHRoaXMuX2Nhc3RlckxpZ2h0UGFzcy5ub3JtYWxNZXRob2QgPSB0aGlzLl9tYXRlcmlhbC5ub3JtYWxNZXRob2Q7XG5cdFx0dGhpcy5fY2FzdGVyTGlnaHRQYXNzLnNwZWN1bGFyTWV0aG9kID0gdGhpcy5fbWF0ZXJpYWwuc3BlY3VsYXJNZXRob2Q7XG5cdH1cblxuXHRwcml2YXRlIHJlbW92ZUNhc3RlckxpZ2h0UGFzcygpXG5cdHtcblx0XHR0aGlzLl9jYXN0ZXJMaWdodFBhc3MuZGlzcG9zZSgpO1xuXHRcdHRoaXMuX3BSZW1vdmVTY3JlZW5QYXNzKHRoaXMuX2Nhc3RlckxpZ2h0UGFzcyk7XG5cdFx0dGhpcy5fY2FzdGVyTGlnaHRQYXNzID0gbnVsbDtcblx0fVxuXG5cdHByaXZhdGUgaW5pdE5vbkNhc3RlckxpZ2h0UGFzc2VzKClcblx0e1xuXHRcdHRoaXMucmVtb3ZlTm9uQ2FzdGVyTGlnaHRQYXNzZXMoKTtcblx0XHR2YXIgcGFzczpNZXRob2RQYXNzO1xuXHRcdHZhciBudW1EaXJMaWdodHM6bnVtYmVyID0gdGhpcy5fbWF0ZXJpYWwubGlnaHRQaWNrZXIubnVtRGlyZWN0aW9uYWxMaWdodHM7XG5cdFx0dmFyIG51bVBvaW50TGlnaHRzOm51bWJlciA9IHRoaXMuX21hdGVyaWFsLmxpZ2h0UGlja2VyLm51bVBvaW50TGlnaHRzO1xuXHRcdHZhciBudW1MaWdodFByb2JlczpudW1iZXIgPSB0aGlzLl9tYXRlcmlhbC5saWdodFBpY2tlci5udW1MaWdodFByb2Jlcztcblx0XHR2YXIgZGlyTGlnaHRPZmZzZXQ6bnVtYmVyID0gMDtcblx0XHR2YXIgcG9pbnRMaWdodE9mZnNldDpudW1iZXIgPSAwO1xuXHRcdHZhciBwcm9iZU9mZnNldDpudW1iZXIgPSAwO1xuXG5cdFx0aWYgKCF0aGlzLl9jYXN0ZXJMaWdodFBhc3MpIHtcblx0XHRcdG51bURpckxpZ2h0cyArPSB0aGlzLl9tYXRlcmlhbC5saWdodFBpY2tlci5udW1DYXN0aW5nRGlyZWN0aW9uYWxMaWdodHM7XG5cdFx0XHRudW1Qb2ludExpZ2h0cyArPSB0aGlzLl9tYXRlcmlhbC5saWdodFBpY2tlci5udW1DYXN0aW5nUG9pbnRMaWdodHM7XG5cdFx0fVxuXG5cdFx0dGhpcy5fbm9uQ2FzdGVyTGlnaHRQYXNzZXMgPSBuZXcgQXJyYXk8TWV0aG9kUGFzcz4oKTtcblxuXHRcdHdoaWxlIChkaXJMaWdodE9mZnNldCA8IG51bURpckxpZ2h0cyB8fCBwb2ludExpZ2h0T2Zmc2V0IDwgbnVtUG9pbnRMaWdodHMgfHwgcHJvYmVPZmZzZXQgPCBudW1MaWdodFByb2Jlcykge1xuXHRcdFx0cGFzcyA9IG5ldyBNZXRob2RQYXNzKE1ldGhvZFBhc3NNb2RlLkxJR0hUSU5HLCB0aGlzLCB0aGlzLl9tYXRlcmlhbCwgdGhpcy5fcmVuZGVyYWJsZUNsYXNzLCB0aGlzLl9zdGFnZSk7XG5cdFx0XHRwYXNzLmluY2x1ZGVDYXN0ZXJzID0gdGhpcy5fbWF0ZXJpYWwuc2hhZG93TWV0aG9kID09IG51bGw7XG5cdFx0XHRwYXNzLmRpcmVjdGlvbmFsTGlnaHRzT2Zmc2V0ID0gZGlyTGlnaHRPZmZzZXQ7XG5cdFx0XHRwYXNzLnBvaW50TGlnaHRzT2Zmc2V0ID0gcG9pbnRMaWdodE9mZnNldDtcblx0XHRcdHBhc3MubGlnaHRQcm9iZXNPZmZzZXQgPSBwcm9iZU9mZnNldDtcblx0XHRcdHBhc3MubGlnaHRQaWNrZXIgPSB0aGlzLl9tYXRlcmlhbC5saWdodFBpY2tlcjtcblx0XHRcdHBhc3MuZGlmZnVzZU1ldGhvZCA9IHRoaXMuX21hdGVyaWFsLmRpZmZ1c2VNZXRob2Q7XG5cdFx0XHRwYXNzLmFtYmllbnRNZXRob2QgPSB0aGlzLl9tYXRlcmlhbC5hbWJpZW50TWV0aG9kO1xuXHRcdFx0cGFzcy5ub3JtYWxNZXRob2QgPSB0aGlzLl9tYXRlcmlhbC5ub3JtYWxNZXRob2Q7XG5cdFx0XHRwYXNzLnNwZWN1bGFyTWV0aG9kID0gdGhpcy5fbWF0ZXJpYWwuc3BlY3VsYXJNZXRob2Q7XG5cdFx0XHR0aGlzLl9ub25DYXN0ZXJMaWdodFBhc3Nlcy5wdXNoKHBhc3MpO1xuXG5cdFx0XHRkaXJMaWdodE9mZnNldCArPSBwYXNzLm51bURpcmVjdGlvbmFsTGlnaHRzO1xuXHRcdFx0cG9pbnRMaWdodE9mZnNldCArPSBwYXNzLm51bVBvaW50TGlnaHRzO1xuXHRcdFx0cHJvYmVPZmZzZXQgKz0gcGFzcy5udW1MaWdodFByb2Jlcztcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIHJlbW92ZU5vbkNhc3RlckxpZ2h0UGFzc2VzKClcblx0e1xuXHRcdGlmICghdGhpcy5fbm9uQ2FzdGVyTGlnaHRQYXNzZXMpXG5cdFx0XHRyZXR1cm47XG5cblx0XHRmb3IgKHZhciBpOm51bWJlciA9IDA7IGkgPCB0aGlzLl9ub25DYXN0ZXJMaWdodFBhc3Nlcy5sZW5ndGg7ICsraSlcblx0XHRcdHRoaXMuX3BSZW1vdmVTY3JlZW5QYXNzKHRoaXMuX25vbkNhc3RlckxpZ2h0UGFzc2VzW2ldKTtcblxuXHRcdHRoaXMuX25vbkNhc3RlckxpZ2h0UGFzc2VzID0gbnVsbDtcblx0fVxuXG5cdHByaXZhdGUgcmVtb3ZlRWZmZWN0UGFzcygpXG5cdHtcblx0XHRpZiAodGhpcy5fc2NyZWVuUGFzcy5hbWJpZW50TWV0aG9kICE9IHRoaXMuX21hdGVyaWFsLmFtYmllbnRNZXRob2QpXG5cdFx0XHR0aGlzLl9zY3JlZW5QYXNzLmFtYmllbnRNZXRob2QuZGlzcG9zZSgpO1xuXG5cdFx0aWYgKHRoaXMuX3NjcmVlblBhc3MuZGlmZnVzZU1ldGhvZCAhPSB0aGlzLl9tYXRlcmlhbC5kaWZmdXNlTWV0aG9kKVxuXHRcdFx0dGhpcy5fc2NyZWVuUGFzcy5kaWZmdXNlTWV0aG9kLmRpc3Bvc2UoKTtcblxuXHRcdGlmICh0aGlzLl9zY3JlZW5QYXNzLnNwZWN1bGFyTWV0aG9kICE9IHRoaXMuX21hdGVyaWFsLnNwZWN1bGFyTWV0aG9kKVxuXHRcdFx0dGhpcy5fc2NyZWVuUGFzcy5zcGVjdWxhck1ldGhvZC5kaXNwb3NlKCk7XG5cblx0XHRpZiAodGhpcy5fc2NyZWVuUGFzcy5ub3JtYWxNZXRob2QgIT0gdGhpcy5fbWF0ZXJpYWwubm9ybWFsTWV0aG9kKVxuXHRcdFx0dGhpcy5fc2NyZWVuUGFzcy5ub3JtYWxNZXRob2QuZGlzcG9zZSgpO1xuXG5cdFx0dGhpcy5fcFJlbW92ZVNjcmVlblBhc3ModGhpcy5fc2NyZWVuUGFzcyk7XG5cdFx0dGhpcy5fc2NyZWVuUGFzcyA9IG51bGw7XG5cdH1cblxuXHRwcml2YXRlIGluaXRFZmZlY3RQYXNzKClcblx0e1xuXHRcdGlmICh0aGlzLl9zY3JlZW5QYXNzID09IG51bGwpXG5cdFx0XHR0aGlzLl9zY3JlZW5QYXNzID0gbmV3IE1ldGhvZFBhc3MoTWV0aG9kUGFzc01vZGUuU1VQRVJfU0hBREVSLCB0aGlzLCB0aGlzLl9tYXRlcmlhbCwgdGhpcy5fcmVuZGVyYWJsZUNsYXNzLCB0aGlzLl9zdGFnZSk7XG5cblx0XHRpZiAodGhpcy5fbWF0ZXJpYWwubW9kZSA9PSBNZXRob2RNYXRlcmlhbE1vZGUuU0lOR0xFX1BBU1MpIHtcblx0XHRcdHRoaXMuX3NjcmVlblBhc3MuYW1iaWVudE1ldGhvZCA9IHRoaXMuX21hdGVyaWFsLmFtYmllbnRNZXRob2Q7XG5cdFx0XHR0aGlzLl9zY3JlZW5QYXNzLmRpZmZ1c2VNZXRob2QgPSB0aGlzLl9tYXRlcmlhbC5kaWZmdXNlTWV0aG9kO1xuXHRcdFx0dGhpcy5fc2NyZWVuUGFzcy5zcGVjdWxhck1ldGhvZCA9IHRoaXMuX21hdGVyaWFsLnNwZWN1bGFyTWV0aG9kO1xuXHRcdFx0dGhpcy5fc2NyZWVuUGFzcy5ub3JtYWxNZXRob2QgPSB0aGlzLl9tYXRlcmlhbC5ub3JtYWxNZXRob2Q7XG5cdFx0XHR0aGlzLl9zY3JlZW5QYXNzLnNoYWRvd01ldGhvZCA9IHRoaXMuX21hdGVyaWFsLnNoYWRvd01ldGhvZDtcblx0XHR9IGVsc2UgaWYgKHRoaXMuX21hdGVyaWFsLm1vZGUgPT0gTWV0aG9kTWF0ZXJpYWxNb2RlLk1VTFRJX1BBU1MpIHtcblx0XHRcdGlmICh0aGlzLm51bUxpZ2h0cyA9PSAwKSB7XG5cdFx0XHRcdHRoaXMuX3NjcmVlblBhc3MuYW1iaWVudE1ldGhvZCA9IHRoaXMuX21hdGVyaWFsLmFtYmllbnRNZXRob2Q7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0aGlzLl9zY3JlZW5QYXNzLmFtYmllbnRNZXRob2QgPSBudWxsO1xuXHRcdFx0fVxuXG5cdFx0XHR0aGlzLl9zY3JlZW5QYXNzLnByZXNlcnZlQWxwaGEgPSBmYWxzZTtcblx0XHRcdHRoaXMuX3NjcmVlblBhc3Mubm9ybWFsTWV0aG9kID0gdGhpcy5fbWF0ZXJpYWwubm9ybWFsTWV0aG9kO1xuXHRcdH1cblxuXHRcdC8vdXBkYXRlIGVmZmVjdCBtZXRob2RzXG5cdFx0dmFyIGk6bnVtYmVyID0gMDtcblx0XHR2YXIgZWZmZWN0TWV0aG9kOkVmZmVjdE1ldGhvZEJhc2U7XG5cdFx0dmFyIGxlbjpudW1iZXIgPSBNYXRoLm1heCh0aGlzLl9tYXRlcmlhbC5udW1FZmZlY3RNZXRob2RzLCB0aGlzLl9zY3JlZW5QYXNzLm51bUVmZmVjdE1ldGhvZHMpO1xuXG5cdFx0d2hpbGUgKGkgPCBsZW4pIHtcblx0XHRcdGVmZmVjdE1ldGhvZCA9IHRoaXMuX21hdGVyaWFsLmdldEVmZmVjdE1ldGhvZEF0KGkpO1xuXHRcdFx0aWYgKGVmZmVjdE1ldGhvZCAhPSB0aGlzLl9zY3JlZW5QYXNzLmdldEVmZmVjdE1ldGhvZEF0KGkpKSB7XG5cdFx0XHRcdHRoaXMuX3NjcmVlblBhc3MucmVtb3ZlRWZmZWN0TWV0aG9kQXQoaSk7XG5cblx0XHRcdFx0aWYgKGVmZmVjdE1ldGhvZCAhPSBudWxsKSB7XG5cdFx0XHRcdFx0aWYgKGkgPCB0aGlzLl9zY3JlZW5QYXNzLm51bUVmZmVjdE1ldGhvZHMpXG5cdFx0XHRcdFx0XHR0aGlzLl9zY3JlZW5QYXNzLmFkZEVmZmVjdE1ldGhvZEF0KGVmZmVjdE1ldGhvZCwgaSk7XG5cdFx0XHRcdFx0ZWxzZVxuXHRcdFx0XHRcdFx0dGhpcy5fc2NyZWVuUGFzcy5hZGRFZmZlY3RNZXRob2QoZWZmZWN0TWV0aG9kKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHRpKys7XG5cdFx0fVxuXHR9XG5cdFxuXHQvKipcblx0ICogQGluaGVyaXREb2Ncblx0ICovXG5cdHB1YmxpYyBkaXNwb3NlKClcblx0e1xuXHRcdHN1cGVyLmRpc3Bvc2UoKTtcblxuXHRcdC8vVE9ET1xuXHR9XG59XG5cbmV4cG9ydCA9IFJlbmRlck1ldGhvZE1hdGVyaWFsT2JqZWN0OyJdfQ==