var Sampler2D = require("awayjs-core/lib/image/Sampler2D");
var URLLoaderEvent = require("awayjs-core/lib/events/URLLoaderEvent");
var RequestAnimationFrame = require("awayjs-core/lib/utils/RequestAnimationFrame");
var Debug = require("awayjs-core/lib/utils/Debug");
var View = require("awayjs-display/lib/View");
var PrimitivePlanePrefab = require("awayjs-display/lib/prefabs/PrimitivePlanePrefab");
var DefaultRenderer = require("awayjs-renderergl/lib/DefaultRenderer");
var BasicMaterial = require("awayjs-display/lib/materials/BasicMaterial");
var URLLoader = require("awayjs-core/lib/net/URLLoader");
var URLLoaderDataFormat = require("awayjs-core/lib/net/URLLoaderDataFormat");
var URLRequest = require("awayjs-core/lib/net/URLRequest");
var ParserUtils = require("awayjs-core/lib/parsers/ParserUtils");
var ElementsType = require("awayjs-display/lib/graphics/ElementsType");
var MipMapSoftwareTest = (function () {
    function MipMapSoftwareTest() {
        var _this = this;
        this.c = 100;
        var pngURLRequest = new URLRequest('assets/dots.png');
        this.pngLoader = new URLLoader();
        this.pngLoader.dataFormat = URLLoaderDataFormat.BLOB;
        this.pngLoader.addEventListener(URLLoaderEvent.LOAD_COMPLETE, function (event) { return _this.pngLoaderComplete(event); });
        this.pngLoader.load(pngURLRequest);
    }
    MipMapSoftwareTest.prototype.pngLoaderComplete = function (event) {
        var _this = this;
        var imageLoader = event.target;
        this.image = ParserUtils.blobToImage(imageLoader.data);
        this.image.onload = function (event) { return _this.onLoadComplete(event); };
    };
    MipMapSoftwareTest.prototype.onLoadComplete = function (event) {
        var _this = this;
        Debug.LOG_PI_ERRORS = false;
        Debug.THROW_ERRORS = false;
        var defaultRenderer = new DefaultRenderer(null, false, "baseline", "software");
        defaultRenderer.antiAlias = 2;
        this.view = new View(defaultRenderer);
        //this.view = new View(new DefaultRenderer(null, false, "baseline"));
        this.raf = new RequestAnimationFrame(this.render, this);
        this.view.backgroundColor = 0x222222;
        window.onresize = function (event) { return _this.onResize(event); };
        this.initSpritees();
        this.raf.start();
        this.onResize();
    };
    MipMapSoftwareTest.prototype.initSpritees = function () {
        //var material:BasicMaterial = new BasicMaterial(DefaultMaterialManager.getDefaultTexture());
        var material = new BasicMaterial(ParserUtils.imageToBitmapImage2D(this.image));
        material.style.sampler = new Sampler2D(true, true, true);
        var plane = new PrimitivePlanePrefab(material, ElementsType.TRIANGLE, 1000, 1000, 1000);
        //var plane:PrimitiveCubePrefab = new PrimitiveCubePrefab();
        plane.material = material;
        var sprite = plane.getNewObject();
        sprite.y = -100;
        this.view.scene.addChild(sprite);
    };
    MipMapSoftwareTest.prototype.render = function () {
        if (this.c > 10) {
            this.c = 0;
            this.view.render();
        }
        this.c++;
    };
    MipMapSoftwareTest.prototype.onResize = function (event) {
        if (event === void 0) { event = null; }
        this.view.y = 0;
        this.view.x = 0;
        this.view.width = window.innerWidth;
        this.view.height = window.innerHeight;
    };
    return MipMapSoftwareTest;
})();

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNvZnR3YXJlL01pcE1hcFNvZnR3YXJlVGVzdC50cyJdLCJuYW1lcyI6WyJNaXBNYXBTb2Z0d2FyZVRlc3QiLCJNaXBNYXBTb2Z0d2FyZVRlc3QuY29uc3RydWN0b3IiLCJNaXBNYXBTb2Z0d2FyZVRlc3QucG5nTG9hZGVyQ29tcGxldGUiLCJNaXBNYXBTb2Z0d2FyZVRlc3Qub25Mb2FkQ29tcGxldGUiLCJNaXBNYXBTb2Z0d2FyZVRlc3QuaW5pdFNwcml0ZWVzIiwiTWlwTWFwU29mdHdhcmVUZXN0LnJlbmRlciIsIk1pcE1hcFNvZnR3YXJlVGVzdC5vblJlc2l6ZSJdLCJtYXBwaW5ncyI6IkFBQ0EsSUFBTyxTQUFTLFdBQWUsaUNBQWlDLENBQUMsQ0FBQztBQUNsRSxJQUFPLGNBQWMsV0FBYyx1Q0FBdUMsQ0FBQyxDQUFDO0FBQzVFLElBQU8scUJBQXFCLFdBQWtCLDZDQUE2QyxDQUFDLENBQUM7QUFDN0YsSUFBTyxLQUFLLFdBQWtDLDZCQUE2QixDQUFDLENBQUM7QUFFN0UsSUFBTyxJQUFJLFdBQXNDLHlCQUF5QixDQUFDLENBQUM7QUFVNUUsSUFBTyxvQkFBb0IsV0FBc0IsaURBQWlELENBQUMsQ0FBQztBQUlwRyxJQUFPLGVBQWUsV0FBMEIsdUNBQXVDLENBQUMsQ0FBQztBQUd6RixJQUFPLGFBQWEsV0FBMEIsNENBQTRDLENBQUMsQ0FBQztBQUM1RixJQUFPLFNBQVMsV0FBZSwrQkFBK0IsQ0FBQyxDQUFDO0FBQ2hFLElBQU8sbUJBQW1CLFdBQWEseUNBQXlDLENBQUMsQ0FBQztBQUNsRixJQUFPLFVBQVUsV0FBZSxnQ0FBZ0MsQ0FBQyxDQUFDO0FBQ2xFLElBQU8sV0FBVyxXQUFlLHFDQUFxQyxDQUFDLENBQUM7QUFDeEUsSUFBTyxZQUFZLFdBQTJCLDBDQUEwQyxDQUFDLENBQUM7QUFFMUYsSUFBTSxrQkFBa0I7SUFPcEJBLFNBUEVBLGtCQUFrQkE7UUFBeEJDLGlCQXdFQ0E7UUFqQldBLE1BQUNBLEdBQVVBLEdBQUdBLENBQUNBO1FBOUNuQkEsSUFBSUEsYUFBYUEsR0FBY0EsSUFBSUEsVUFBVUEsQ0FBQ0EsaUJBQWlCQSxDQUFDQSxDQUFDQTtRQUVqRUEsSUFBSUEsQ0FBQ0EsU0FBU0EsR0FBR0EsSUFBSUEsU0FBU0EsRUFBRUEsQ0FBQ0E7UUFDakNBLElBQUlBLENBQUNBLFNBQVNBLENBQUNBLFVBQVVBLEdBQUdBLG1CQUFtQkEsQ0FBQ0EsSUFBSUEsQ0FBQ0E7UUFDckRBLElBQUlBLENBQUNBLFNBQVNBLENBQUNBLGdCQUFnQkEsQ0FBQ0EsY0FBY0EsQ0FBQ0EsYUFBYUEsRUFBRUEsVUFBQ0EsS0FBb0JBLElBQUtBLE9BQUFBLEtBQUlBLENBQUNBLGlCQUFpQkEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsRUFBN0JBLENBQTZCQSxDQUFDQSxDQUFDQTtRQUN2SEEsSUFBSUEsQ0FBQ0EsU0FBU0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsYUFBYUEsQ0FBQ0EsQ0FBQ0E7SUFDdkNBLENBQUNBO0lBRU9ELDhDQUFpQkEsR0FBekJBLFVBQTBCQSxLQUFvQkE7UUFBOUNFLGlCQUlDQTtRQUhHQSxJQUFJQSxXQUFXQSxHQUFhQSxLQUFLQSxDQUFDQSxNQUFNQSxDQUFDQTtRQUN6Q0EsSUFBSUEsQ0FBQ0EsS0FBS0EsR0FBR0EsV0FBV0EsQ0FBQ0EsV0FBV0EsQ0FBQ0EsV0FBV0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0E7UUFDdkRBLElBQUlBLENBQUNBLEtBQUtBLENBQUNBLE1BQU1BLEdBQUdBLFVBQUNBLEtBQUtBLElBQUtBLE9BQUFBLEtBQUlBLENBQUNBLGNBQWNBLENBQUNBLEtBQUtBLENBQUNBLEVBQTFCQSxDQUEwQkEsQ0FBQ0E7SUFDOURBLENBQUNBO0lBRU9GLDJDQUFjQSxHQUF0QkEsVUFBdUJBLEtBQUtBO1FBQTVCRyxpQkFpQkNBO1FBaEJHQSxLQUFLQSxDQUFDQSxhQUFhQSxHQUFHQSxLQUFLQSxDQUFDQTtRQUM1QkEsS0FBS0EsQ0FBQ0EsWUFBWUEsR0FBR0EsS0FBS0EsQ0FBQ0E7UUFFM0JBLElBQUlBLGVBQWVBLEdBQW1CQSxJQUFJQSxlQUFlQSxDQUFDQSxJQUFJQSxFQUFFQSxLQUFLQSxFQUFFQSxVQUFVQSxFQUFFQSxVQUFVQSxDQUFDQSxDQUFDQTtRQUMvRkEsZUFBZUEsQ0FBQ0EsU0FBU0EsR0FBR0EsQ0FBQ0EsQ0FBQ0E7UUFDOUJBLElBQUlBLENBQUNBLElBQUlBLEdBQUdBLElBQUlBLElBQUlBLENBQUNBLGVBQWVBLENBQUNBLENBQUNBO1FBQ3RDQSxBQUNBQSxxRUFEcUVBO1FBQ3JFQSxJQUFJQSxDQUFDQSxHQUFHQSxHQUFHQSxJQUFJQSxxQkFBcUJBLENBQUNBLElBQUlBLENBQUNBLE1BQU1BLEVBQUVBLElBQUlBLENBQUNBLENBQUNBO1FBRXhEQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFDQSxlQUFlQSxHQUFHQSxRQUFRQSxDQUFDQTtRQUVyQ0EsTUFBTUEsQ0FBQ0EsUUFBUUEsR0FBR0EsVUFBQ0EsS0FBYUEsSUFBS0EsT0FBQUEsS0FBSUEsQ0FBQ0EsUUFBUUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsRUFBcEJBLENBQW9CQSxDQUFDQTtRQUUxREEsSUFBSUEsQ0FBQ0EsWUFBWUEsRUFBRUEsQ0FBQ0E7UUFDcEJBLElBQUlBLENBQUNBLEdBQUdBLENBQUNBLEtBQUtBLEVBQUVBLENBQUNBO1FBQ2pCQSxJQUFJQSxDQUFDQSxRQUFRQSxFQUFFQSxDQUFDQTtJQUNwQkEsQ0FBQ0E7SUFFT0gseUNBQVlBLEdBQXBCQTtRQUNJSSxBQUNBQSw2RkFENkZBO1lBQ3pGQSxRQUFRQSxHQUFpQkEsSUFBSUEsYUFBYUEsQ0FBQ0EsV0FBV0EsQ0FBQ0Esb0JBQW9CQSxDQUFDQSxJQUFJQSxDQUFDQSxLQUFLQSxDQUFDQSxDQUFDQSxDQUFDQTtRQUM3RkEsUUFBUUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsT0FBT0EsR0FBR0EsSUFBSUEsU0FBU0EsQ0FBQ0EsSUFBSUEsRUFBRUEsSUFBSUEsRUFBRUEsSUFBSUEsQ0FBQ0EsQ0FBQ0E7UUFDekRBLElBQUlBLEtBQUtBLEdBQXdCQSxJQUFJQSxvQkFBb0JBLENBQUNBLFFBQVFBLEVBQUVBLFlBQVlBLENBQUNBLFFBQVFBLEVBQUVBLElBQUlBLEVBQUNBLElBQUlBLEVBQUNBLElBQUlBLENBQUNBLENBQUNBO1FBQzNHQSxBQUNBQSw0REFENERBO1FBQzVEQSxLQUFLQSxDQUFDQSxRQUFRQSxHQUFHQSxRQUFRQSxDQUFDQTtRQUUxQkEsSUFBSUEsTUFBTUEsR0FBa0JBLEtBQUtBLENBQUNBLFlBQVlBLEVBQUVBLENBQUNBO1FBQ2pEQSxNQUFNQSxDQUFDQSxDQUFDQSxHQUFHQSxDQUFDQSxHQUFHQSxDQUFDQTtRQUNoQkEsSUFBSUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsS0FBS0EsQ0FBQ0EsUUFBUUEsQ0FBQ0EsTUFBTUEsQ0FBQ0EsQ0FBQ0E7SUFDckNBLENBQUNBO0lBSU9KLG1DQUFNQSxHQUFkQTtRQUNJSyxFQUFFQSxDQUFDQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxHQUFHQSxFQUFFQSxDQUFDQSxDQUFDQSxDQUFDQTtZQUNkQSxJQUFJQSxDQUFDQSxDQUFDQSxHQUFHQSxDQUFDQSxDQUFDQTtZQUNYQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFDQSxNQUFNQSxFQUFFQSxDQUFDQTtRQUN2QkEsQ0FBQ0E7UUFDREEsSUFBSUEsQ0FBQ0EsQ0FBQ0EsRUFBRUEsQ0FBQ0E7SUFDYkEsQ0FBQ0E7SUFFTUwscUNBQVFBLEdBQWZBLFVBQWdCQSxLQUFvQkE7UUFBcEJNLHFCQUFvQkEsR0FBcEJBLFlBQW9CQTtRQUNoQ0EsSUFBSUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0E7UUFDaEJBLElBQUlBLENBQUNBLElBQUlBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBO1FBRWhCQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFDQSxLQUFLQSxHQUFHQSxNQUFNQSxDQUFDQSxVQUFVQSxDQUFDQTtRQUNwQ0EsSUFBSUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsTUFBTUEsR0FBR0EsTUFBTUEsQ0FBQ0EsV0FBV0EsQ0FBQ0E7SUFDMUNBLENBQUNBO0lBQ0xOLHlCQUFDQTtBQUFEQSxDQXhFQSxBQXdFQ0EsSUFBQSIsImZpbGUiOiJzb2Z0d2FyZS9NaXBNYXBTb2Z0d2FyZVRlc3QuanMiLCJzb3VyY2VSb290IjoiLi90ZXN0cyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBWZWN0b3IzRCAgICAgICAgICAgICAgICAgICAgICAgID0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi9nZW9tL1ZlY3RvcjNEXCIpO1xuaW1wb3J0IFNhbXBsZXIyRFx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvaW1hZ2UvU2FtcGxlcjJEXCIpO1xuaW1wb3J0IFVSTExvYWRlckV2ZW50XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvZXZlbnRzL1VSTExvYWRlckV2ZW50XCIpO1xuaW1wb3J0IFJlcXVlc3RBbmltYXRpb25GcmFtZSAgICAgICAgPSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL3V0aWxzL1JlcXVlc3RBbmltYXRpb25GcmFtZVwiKTtcbmltcG9ydCBEZWJ1ZyAgICAgICAgICAgICAgICAgICAgICAgID0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi91dGlscy9EZWJ1Z1wiKTtcblxuaW1wb3J0IFZpZXcgICAgICAgICAgICAgICAgICAgICAgICAgICAgPSByZXF1aXJlKFwiYXdheWpzLWRpc3BsYXkvbGliL1ZpZXdcIik7XG5pbXBvcnQgU3ByaXRlICAgICAgICAgICAgICAgICAgICAgICAgICAgID0gcmVxdWlyZShcImF3YXlqcy1kaXNwbGF5L2xpYi9kaXNwbGF5L1Nwcml0ZVwiKTtcbmltcG9ydCBEaXJlY3Rpb25hbExpZ2h0ICAgICAgICAgICAgICAgID0gcmVxdWlyZShcImF3YXlqcy1kaXNwbGF5L2xpYi9kaXNwbGF5L0RpcmVjdGlvbmFsTGlnaHRcIik7XG5pbXBvcnQgRGVmYXVsdE1hdGVyaWFsTWFuYWdlciAgICAgICAgPSByZXF1aXJlKFwiYXdheWpzLWRpc3BsYXkvbGliL21hbmFnZXJzL0RlZmF1bHRNYXRlcmlhbE1hbmFnZXJcIik7XG5pbXBvcnQgU3RhdGljTGlnaHRQaWNrZXIgICAgICAgICAgICA9IHJlcXVpcmUoXCJhd2F5anMtZGlzcGxheS9saWIvbWF0ZXJpYWxzL2xpZ2h0cGlja2Vycy9TdGF0aWNMaWdodFBpY2tlclwiKTtcbmltcG9ydCBQcmltaXRpdmVQcmVmYWJCYXNlICAgICAgICAgICAgPSByZXF1aXJlKFwiYXdheWpzLWRpc3BsYXkvbGliL3ByZWZhYnMvUHJpbWl0aXZlUHJlZmFiQmFzZVwiKTtcbmltcG9ydCBQcmltaXRpdmVDYXBzdWxlUHJlZmFiICAgICAgICA9IHJlcXVpcmUoXCJhd2F5anMtZGlzcGxheS9saWIvcHJlZmFicy9QcmltaXRpdmVDYXBzdWxlUHJlZmFiXCIpO1xuaW1wb3J0IFByaW1pdGl2ZUNvbmVQcmVmYWIgICAgICAgICAgICA9IHJlcXVpcmUoXCJhd2F5anMtZGlzcGxheS9saWIvcHJlZmFicy9QcmltaXRpdmVDb25lUHJlZmFiXCIpO1xuaW1wb3J0IFByaW1pdGl2ZUN1YmVQcmVmYWIgICAgICAgICAgICA9IHJlcXVpcmUoXCJhd2F5anMtZGlzcGxheS9saWIvcHJlZmFicy9QcmltaXRpdmVDdWJlUHJlZmFiXCIpO1xuaW1wb3J0IFByaW1pdGl2ZUN5bGluZGVyUHJlZmFiICAgICAgICA9IHJlcXVpcmUoXCJhd2F5anMtZGlzcGxheS9saWIvcHJlZmFicy9QcmltaXRpdmVDeWxpbmRlclByZWZhYlwiKTtcbmltcG9ydCBQcmltaXRpdmVQbGFuZVByZWZhYiAgICAgICAgICAgID0gcmVxdWlyZShcImF3YXlqcy1kaXNwbGF5L2xpYi9wcmVmYWJzL1ByaW1pdGl2ZVBsYW5lUHJlZmFiXCIpO1xuaW1wb3J0IFByaW1pdGl2ZVNwaGVyZVByZWZhYiAgICAgICAgPSByZXF1aXJlKFwiYXdheWpzLWRpc3BsYXkvbGliL3ByZWZhYnMvUHJpbWl0aXZlU3BoZXJlUHJlZmFiXCIpO1xuaW1wb3J0IFByaW1pdGl2ZVRvcnVzUHJlZmFiICAgICAgICAgICAgPSByZXF1aXJlKFwiYXdheWpzLWRpc3BsYXkvbGliL3ByZWZhYnMvUHJpbWl0aXZlVG9ydXNQcmVmYWJcIik7XG5cbmltcG9ydCBEZWZhdWx0UmVuZGVyZXIgICAgICAgICAgICAgICAgPSByZXF1aXJlKFwiYXdheWpzLXJlbmRlcmVyZ2wvbGliL0RlZmF1bHRSZW5kZXJlclwiKTtcblxuaW1wb3J0IE1ldGhvZE1hdGVyaWFsICAgICAgICAgICAgICAgID0gcmVxdWlyZShcImF3YXlqcy1tZXRob2RtYXRlcmlhbHMvbGliL01ldGhvZE1hdGVyaWFsXCIpO1xuaW1wb3J0IEJhc2ljTWF0ZXJpYWwgICAgICAgICAgICAgICAgPSByZXF1aXJlKFwiYXdheWpzLWRpc3BsYXkvbGliL21hdGVyaWFscy9CYXNpY01hdGVyaWFsXCIpO1xuaW1wb3J0IFVSTExvYWRlclx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvbmV0L1VSTExvYWRlclwiKTtcbmltcG9ydCBVUkxMb2FkZXJEYXRhRm9ybWF0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL25ldC9VUkxMb2FkZXJEYXRhRm9ybWF0XCIpO1xuaW1wb3J0IFVSTFJlcXVlc3RcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL25ldC9VUkxSZXF1ZXN0XCIpO1xuaW1wb3J0IFBhcnNlclV0aWxzXHRcdFx0XHRcdD0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi9wYXJzZXJzL1BhcnNlclV0aWxzXCIpO1xuaW1wb3J0IEVsZW1lbnRzVHlwZSAgICAgICAgICAgICAgICAgPSByZXF1aXJlKFwiYXdheWpzLWRpc3BsYXkvbGliL2dyYXBoaWNzL0VsZW1lbnRzVHlwZVwiKTtcblxuY2xhc3MgTWlwTWFwU29mdHdhcmVUZXN0IHtcblxuICAgIHByaXZhdGUgdmlldzpWaWV3O1xuICAgIHByaXZhdGUgcmFmOlJlcXVlc3RBbmltYXRpb25GcmFtZTtcbiAgICBwcml2YXRlIHBuZ0xvYWRlciAgIDogVVJMTG9hZGVyO1xuICAgIHByaXZhdGUgaW1hZ2U6SFRNTEltYWdlRWxlbWVudDtcblxuICAgIGNvbnN0cnVjdG9yKCkge1xuXG4gICAgICAgIHZhciBwbmdVUkxSZXF1ZXN0OlVSTFJlcXVlc3QgPSBuZXcgVVJMUmVxdWVzdCgnYXNzZXRzL2RvdHMucG5nJyk7XG5cbiAgICAgICAgdGhpcy5wbmdMb2FkZXIgPSBuZXcgVVJMTG9hZGVyKCk7XG4gICAgICAgIHRoaXMucG5nTG9hZGVyLmRhdGFGb3JtYXQgPSBVUkxMb2FkZXJEYXRhRm9ybWF0LkJMT0I7XG4gICAgICAgIHRoaXMucG5nTG9hZGVyLmFkZEV2ZW50TGlzdGVuZXIoVVJMTG9hZGVyRXZlbnQuTE9BRF9DT01QTEVURSwgKGV2ZW50OlVSTExvYWRlckV2ZW50KSA9PiB0aGlzLnBuZ0xvYWRlckNvbXBsZXRlKGV2ZW50KSk7XG4gICAgICAgIHRoaXMucG5nTG9hZGVyLmxvYWQocG5nVVJMUmVxdWVzdCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBwbmdMb2FkZXJDb21wbGV0ZShldmVudDpVUkxMb2FkZXJFdmVudCkge1xuICAgICAgICB2YXIgaW1hZ2VMb2FkZXI6VVJMTG9hZGVyID0gZXZlbnQudGFyZ2V0O1xuICAgICAgICB0aGlzLmltYWdlID0gUGFyc2VyVXRpbHMuYmxvYlRvSW1hZ2UoaW1hZ2VMb2FkZXIuZGF0YSk7XG4gICAgICAgIHRoaXMuaW1hZ2Uub25sb2FkID0gKGV2ZW50KSA9PiB0aGlzLm9uTG9hZENvbXBsZXRlKGV2ZW50KTtcbiAgICB9XG5cbiAgICBwcml2YXRlIG9uTG9hZENvbXBsZXRlKGV2ZW50KSB7XG4gICAgICAgIERlYnVnLkxPR19QSV9FUlJPUlMgPSBmYWxzZTtcbiAgICAgICAgRGVidWcuVEhST1dfRVJST1JTID0gZmFsc2U7XG5cbiAgICAgICAgdmFyIGRlZmF1bHRSZW5kZXJlcjpEZWZhdWx0UmVuZGVyZXIgPSBuZXcgRGVmYXVsdFJlbmRlcmVyKG51bGwsIGZhbHNlLCBcImJhc2VsaW5lXCIsIFwic29mdHdhcmVcIik7XG4gICAgICAgIGRlZmF1bHRSZW5kZXJlci5hbnRpQWxpYXMgPSAyO1xuICAgICAgICB0aGlzLnZpZXcgPSBuZXcgVmlldyhkZWZhdWx0UmVuZGVyZXIpO1xuICAgICAgICAvL3RoaXMudmlldyA9IG5ldyBWaWV3KG5ldyBEZWZhdWx0UmVuZGVyZXIobnVsbCwgZmFsc2UsIFwiYmFzZWxpbmVcIikpO1xuICAgICAgICB0aGlzLnJhZiA9IG5ldyBSZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy5yZW5kZXIsIHRoaXMpO1xuXG4gICAgICAgIHRoaXMudmlldy5iYWNrZ3JvdW5kQ29sb3IgPSAweDIyMjIyMjtcblxuICAgICAgICB3aW5kb3cub25yZXNpemUgPSAoZXZlbnQ6VUlFdmVudCkgPT4gdGhpcy5vblJlc2l6ZShldmVudCk7XG5cbiAgICAgICAgdGhpcy5pbml0U3ByaXRlZXMoKTtcbiAgICAgICAgdGhpcy5yYWYuc3RhcnQoKTtcbiAgICAgICAgdGhpcy5vblJlc2l6ZSgpO1xuICAgIH1cblxuICAgIHByaXZhdGUgaW5pdFNwcml0ZWVzKCk6dm9pZCB7XG4gICAgICAgIC8vdmFyIG1hdGVyaWFsOkJhc2ljTWF0ZXJpYWwgPSBuZXcgQmFzaWNNYXRlcmlhbChEZWZhdWx0TWF0ZXJpYWxNYW5hZ2VyLmdldERlZmF1bHRUZXh0dXJlKCkpO1xuICAgICAgICB2YXIgbWF0ZXJpYWw6QmFzaWNNYXRlcmlhbCA9IG5ldyBCYXNpY01hdGVyaWFsKFBhcnNlclV0aWxzLmltYWdlVG9CaXRtYXBJbWFnZTJEKHRoaXMuaW1hZ2UpKTtcbiAgICAgICAgbWF0ZXJpYWwuc3R5bGUuc2FtcGxlciA9IG5ldyBTYW1wbGVyMkQodHJ1ZSwgdHJ1ZSwgdHJ1ZSk7XG4gICAgICAgIHZhciBwbGFuZTpQcmltaXRpdmVQbGFuZVByZWZhYiA9IG5ldyBQcmltaXRpdmVQbGFuZVByZWZhYihtYXRlcmlhbCwgRWxlbWVudHNUeXBlLlRSSUFOR0xFLCAxMDAwLDEwMDAsMTAwMCk7XG4gICAgICAgIC8vdmFyIHBsYW5lOlByaW1pdGl2ZUN1YmVQcmVmYWIgPSBuZXcgUHJpbWl0aXZlQ3ViZVByZWZhYigpO1xuICAgICAgICBwbGFuZS5tYXRlcmlhbCA9IG1hdGVyaWFsO1xuXG4gICAgICAgIHZhciBzcHJpdGU6U3ByaXRlID0gPFNwcml0ZT5wbGFuZS5nZXROZXdPYmplY3QoKTtcbiAgICAgICAgc3ByaXRlLnkgPSAtMTAwO1xuICAgICAgICB0aGlzLnZpZXcuc2NlbmUuYWRkQ2hpbGQoc3ByaXRlKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGM6bnVtYmVyID0gMTAwO1xuXG4gICAgcHJpdmF0ZSByZW5kZXIoKSB7XG4gICAgICAgIGlmICh0aGlzLmMgPiAxMCkge1xuICAgICAgICAgICAgdGhpcy5jID0gMDtcbiAgICAgICAgICAgIHRoaXMudmlldy5yZW5kZXIoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmMrKztcbiAgICB9XG5cbiAgICBwdWJsaWMgb25SZXNpemUoZXZlbnQ6VUlFdmVudCA9IG51bGwpIHtcbiAgICAgICAgdGhpcy52aWV3LnkgPSAwO1xuICAgICAgICB0aGlzLnZpZXcueCA9IDA7XG5cbiAgICAgICAgdGhpcy52aWV3LndpZHRoID0gd2luZG93LmlubmVyV2lkdGg7XG4gICAgICAgIHRoaXMudmlldy5oZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQ7XG4gICAgfVxufSJdfQ==