var Event = require("awayjs-core/lib/events/Event");
var RequestAnimationFrame = require("awayjs-core/lib/utils/RequestAnimationFrame");
var Debug = require("awayjs-core/lib/utils/Debug");
var View = require("awayjs-display/lib/containers/View");
var PrimitivePlanePrefab = require("awayjs-display/lib/prefabs/PrimitivePlanePrefab");
var DefaultRenderer = require("awayjs-renderergl/lib/DefaultRenderer");
var BasicMaterial = require("awayjs-display/lib/materials/BasicMaterial");
var URLLoader = require("awayjs-core/lib/net/URLLoader");
var URLLoaderDataFormat = require("awayjs-core/lib/net/URLLoaderDataFormat");
var URLRequest = require("awayjs-core/lib/net/URLRequest");
var ParserUtils = require("awayjs-core/lib/parsers/ParserUtils");
var MipMapSoftwareTest = (function () {
    function MipMapSoftwareTest() {
        var _this = this;
        this.c = 100;
        var pngURLRequest = new URLRequest('assets/dots.png');
        this.pngLoader = new URLLoader();
        this.pngLoader.dataFormat = URLLoaderDataFormat.BLOB;
        this.pngLoader.addEventListener(Event.COMPLETE, function (event) { return _this.pngLoaderComplete(event); });
        this.pngLoader.load(pngURLRequest);
    }
    MipMapSoftwareTest.prototype.pngLoaderComplete = function (event) {
        var _this = this;
        var imageLoader = event.target;
        this.image = ParserUtils.blobToImage(imageLoader.data);
        this.image.onload = function (event) { return _this.onLoadComplete(event); };
    };
    MipMapSoftwareTest.prototype.onLoadComplete = function (event) {
        var _this = this;
        Debug.LOG_PI_ERRORS = false;
        Debug.THROW_ERRORS = false;
        var defaultRenderer = new DefaultRenderer(null, false, "baseline", "software");
        defaultRenderer.antiAlias = 2;
        this.view = new View(defaultRenderer);
        //this.view = new View(new DefaultRenderer(null, false, "baseline"));
        this.raf = new RequestAnimationFrame(this.render, this);
        this.view.backgroundColor = 0x222222;
        window.onresize = function (event) { return _this.onResize(event); };
        this.initMeshes();
        this.raf.start();
        this.onResize();
    };
    MipMapSoftwareTest.prototype.initMeshes = function () {
        //var material:BasicMaterial = new BasicMaterial(DefaultMaterialManager.getDefaultTexture());
        var material = new BasicMaterial(ParserUtils.imageToBitmapImage2D(this.image));
        material.smooth = true;
        material.repeat = true;
        material.mipmap = true;
        var plane = new PrimitivePlanePrefab(1000, 1000, 1000);
        //var plane:PrimitiveCubePrefab = new PrimitiveCubePrefab();
        plane.material = material;
        var mesh = plane.getNewObject();
        mesh.y = -100;
        this.view.scene.addChild(mesh);
    };
    MipMapSoftwareTest.prototype.render = function () {
        if (this.c > 10) {
            this.c = 0;
            this.view.render();
        }
        this.c++;
    };
    MipMapSoftwareTest.prototype.onResize = function (event) {
        if (event === void 0) { event = null; }
        this.view.y = 0;
        this.view.x = 0;
        this.view.width = window.innerWidth;
        this.view.height = window.innerHeight;
    };
    return MipMapSoftwareTest;
})();

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNvZnR3YXJlL01pcE1hcFNvZnR3YXJlVGVzdC50cyJdLCJuYW1lcyI6WyJNaXBNYXBTb2Z0d2FyZVRlc3QiLCJNaXBNYXBTb2Z0d2FyZVRlc3QuY29uc3RydWN0b3IiLCJNaXBNYXBTb2Z0d2FyZVRlc3QucG5nTG9hZGVyQ29tcGxldGUiLCJNaXBNYXBTb2Z0d2FyZVRlc3Qub25Mb2FkQ29tcGxldGUiLCJNaXBNYXBTb2Z0d2FyZVRlc3QuaW5pdE1lc2hlcyIsIk1pcE1hcFNvZnR3YXJlVGVzdC5yZW5kZXIiLCJNaXBNYXBTb2Z0d2FyZVRlc3Qub25SZXNpemUiXSwibWFwcGluZ3MiOiJBQUNBLElBQU8sS0FBSyxXQUFrQyw4QkFBOEIsQ0FBQyxDQUFDO0FBQzlFLElBQU8scUJBQXFCLFdBQWtCLDZDQUE2QyxDQUFDLENBQUM7QUFDN0YsSUFBTyxLQUFLLFdBQWtDLDZCQUE2QixDQUFDLENBQUM7QUFFN0UsSUFBTyxJQUFJLFdBQXNDLG9DQUFvQyxDQUFDLENBQUM7QUFVdkYsSUFBTyxvQkFBb0IsV0FBc0IsaURBQWlELENBQUMsQ0FBQztBQUlwRyxJQUFPLGVBQWUsV0FBMEIsdUNBQXVDLENBQUMsQ0FBQztBQUd6RixJQUFPLGFBQWEsV0FBMEIsNENBQTRDLENBQUMsQ0FBQztBQUM1RixJQUFPLFNBQVMsV0FBZSwrQkFBK0IsQ0FBQyxDQUFDO0FBQ2hFLElBQU8sbUJBQW1CLFdBQWEseUNBQXlDLENBQUMsQ0FBQztBQUNsRixJQUFPLFVBQVUsV0FBZSxnQ0FBZ0MsQ0FBQyxDQUFDO0FBQ2xFLElBQU8sV0FBVyxXQUFlLHFDQUFxQyxDQUFDLENBQUM7QUFFeEU7SUFPSUE7UUFQSkMsaUJBMEVDQTtRQWpCV0EsTUFBQ0EsR0FBVUEsR0FBR0EsQ0FBQ0E7UUFoRG5CQSxJQUFJQSxhQUFhQSxHQUFjQSxJQUFJQSxVQUFVQSxDQUFDQSxpQkFBaUJBLENBQUNBLENBQUNBO1FBRWpFQSxJQUFJQSxDQUFDQSxTQUFTQSxHQUFHQSxJQUFJQSxTQUFTQSxFQUFFQSxD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SUEsSUFBSUEsR0FBY0EsS0FBS0EsQ0FBQ0EsWUFBWUEsRUFBRUEsQ0FBQ0E7UUFDM0NBLElBQUlBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLEdBQUdBLENBQUNBO1FBQ2RBLElBQUlBLENBQUNBLElBQUlBLENBQUNBLEtBQUtBLENBQUNBLFFBQVFBLENBQUNBLElBQUlBLENBQUNBLENBQUNBO0lBQ25DQSxDQUFDQTtJQUlPSixtQ0FBTUEsR0FBZEE7UUFDSUssRUFBRUEsQ0FBQ0EsQ0FBQ0EsSUFBSUEsQ0FBQ0EsQ0FBQ0EsR0FBR0EsRUFBRUEsQ0FBQ0EsQ0FBQ0EsQ0FBQ0E7WUFDZEEsSUFBSUEsQ0FBQ0EsQ0FBQ0EsR0FBR0EsQ0FBQ0EsQ0FBQ0E7WUFDWEEsSUFBSUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsTUFBTUEsRUFBRUEsQ0FBQ0E7UUFDdkJBLENBQUNBO1FBQ0RBLElBQUlBLENBQUNBLENBQUNBLEVBQUVBLENBQUNBO0lBQ2JBLENBQUNBO0lBRU1MLHFDQUFRQSxHQUFmQSxVQUFnQkEsS0FBb0JBO1FBQXBCTSxxQkFBb0JBLEdBQXBCQSxZQUFvQkE7UUFDaENBLElBQUlBLENBQUNBLElBQUlBLENBQUNBLENBQUNBLEdBQUdBLENBQUNBLENBQUNBO1FBQ2hCQSxJQUFJQSxDQUFDQSxJQUFJQSxDQUFDQSxDQUFDQSxHQUFHQSxDQUFDQSxDQUFDQTtRQUVoQkEsSUFBSUEsQ0FBQ0EsSUFBSUEsQ0FBQ0EsS0FBS0EsR0FBR0EsTUFBTUEsQ0FBQ0EsVUFBVUEsQ0FBQ0E7UUFDcENBLElBQUlBLENBQUNBLElBQUlBLENBQUNBLE1BQU1BLEdBQUdBLE1BQU1BLENBQUNBLFdBQVdBLENBQUNBO0lBQzFDQSxDQUFDQTtJQUNMTix5QkFBQ0E7QUFBREEsQ0ExRUEsQUEwRUNBLElBQUEiLCJmaWxlIjoic29mdHdhcmUvTWlwTWFwU29mdHdhcmVUZXN0LmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFZlY3RvcjNEICAgICAgICAgICAgICAgICAgICAgICAgPSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL2dlb20vVmVjdG9yM0RcIik7XHJcbmltcG9ydCBFdmVudCAgICAgICAgICAgICAgICAgICAgICAgID0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi9ldmVudHMvRXZlbnRcIik7XHJcbmltcG9ydCBSZXF1ZXN0QW5pbWF0aW9uRnJhbWUgICAgICAgID0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi91dGlscy9SZXF1ZXN0QW5pbWF0aW9uRnJhbWVcIik7XHJcbmltcG9ydCBEZWJ1ZyAgICAgICAgICAgICAgICAgICAgICAgID0gcmVxdWlyZShcImF3YXlqcy1jb3JlL2xpYi91dGlscy9EZWJ1Z1wiKTtcclxuXHJcbmltcG9ydCBWaWV3ICAgICAgICAgICAgICAgICAgICAgICAgICAgID0gcmVxdWlyZShcImF3YXlqcy1kaXNwbGF5L2xpYi9jb250YWluZXJzL1ZpZXdcIik7XHJcbmltcG9ydCBNZXNoICAgICAgICAgICAgICAgICAgICAgICAgICAgID0gcmVxdWlyZShcImF3YXlqcy1kaXNwbGF5L2xpYi9lbnRpdGllcy9NZXNoXCIpO1xyXG5pbXBvcnQgRGlyZWN0aW9uYWxMaWdodCAgICAgICAgICAgICAgICA9IHJlcXVpcmUoXCJhd2F5anMtZGlzcGxheS9saWIvZW50aXRpZXMvRGlyZWN0aW9uYWxMaWdodFwiKTtcclxuaW1wb3J0IERlZmF1bHRNYXRlcmlhbE1hbmFnZXIgICAgICAgID0gcmVxdWlyZShcImF3YXlqcy1kaXNwbGF5L2xpYi9tYW5hZ2Vycy9EZWZhdWx0TWF0ZXJpYWxNYW5hZ2VyXCIpO1xyXG5pbXBvcnQgU3RhdGljTGlnaHRQaWNrZXIgICAgICAgICAgICA9IHJlcXVpcmUoXCJhd2F5anMtZGlzcGxheS9saWIvbWF0ZXJpYWxzL2xpZ2h0cGlja2Vycy9TdGF0aWNMaWdodFBpY2tlclwiKTtcclxuaW1wb3J0IFByaW1pdGl2ZVByZWZhYkJhc2UgICAgICAgICAgICA9IHJlcXVpcmUoXCJhd2F5anMtZGlzcGxheS9saWIvcHJlZmFicy9QcmltaXRpdmVQcmVmYWJCYXNlXCIpO1xyXG5pbXBvcnQgUHJpbWl0aXZlQ2Fwc3VsZVByZWZhYiAgICAgICAgPSByZXF1aXJlKFwiYXdheWpzLWRpc3BsYXkvbGliL3ByZWZhYnMvUHJpbWl0aXZlQ2Fwc3VsZVByZWZhYlwiKTtcclxuaW1wb3J0IFByaW1pdGl2ZUNvbmVQcmVmYWIgICAgICAgICAgICA9IHJlcXVpcmUoXCJhd2F5anMtZGlzcGxheS9saWIvcHJlZmFicy9QcmltaXRpdmVDb25lUHJlZmFiXCIpO1xyXG5pbXBvcnQgUHJpbWl0aXZlQ3ViZVByZWZhYiAgICAgICAgICAgID0gcmVxdWlyZShcImF3YXlqcy1kaXNwbGF5L2xpYi9wcmVmYWJzL1ByaW1pdGl2ZUN1YmVQcmVmYWJcIik7XHJcbmltcG9ydCBQcmltaXRpdmVDeWxpbmRlclByZWZhYiAgICAgICAgPSByZXF1aXJlKFwiYXdheWpzLWRpc3BsYXkvbGliL3ByZWZhYnMvUHJpbWl0aXZlQ3lsaW5kZXJQcmVmYWJcIik7XHJcbmltcG9ydCBQcmltaXRpdmVQbGFuZVByZWZhYiAgICAgICAgICAgID0gcmVxdWlyZShcImF3YXlqcy1kaXNwbGF5L2xpYi9wcmVmYWJzL1ByaW1pdGl2ZVBsYW5lUHJlZmFiXCIpO1xyXG5pbXBvcnQgUHJpbWl0aXZlU3BoZXJlUHJlZmFiICAgICAgICA9IHJlcXVpcmUoXCJhd2F5anMtZGlzcGxheS9saWIvcHJlZmFicy9QcmltaXRpdmVTcGhlcmVQcmVmYWJcIik7XHJcbmltcG9ydCBQcmltaXRpdmVUb3J1c1ByZWZhYiAgICAgICAgICAgID0gcmVxdWlyZShcImF3YXlqcy1kaXNwbGF5L2xpYi9wcmVmYWJzL1ByaW1pdGl2ZVRvcnVzUHJlZmFiXCIpO1xyXG5cclxuaW1wb3J0IERlZmF1bHRSZW5kZXJlciAgICAgICAgICAgICAgICA9IHJlcXVpcmUoXCJhd2F5anMtcmVuZGVyZXJnbC9saWIvRGVmYXVsdFJlbmRlcmVyXCIpO1xyXG5cclxuaW1wb3J0IE1ldGhvZE1hdGVyaWFsICAgICAgICAgICAgICAgID0gcmVxdWlyZShcImF3YXlqcy1tZXRob2RtYXRlcmlhbHMvbGliL01ldGhvZE1hdGVyaWFsXCIpO1xyXG5pbXBvcnQgQmFzaWNNYXRlcmlhbCAgICAgICAgICAgICAgICA9IHJlcXVpcmUoXCJhd2F5anMtZGlzcGxheS9saWIvbWF0ZXJpYWxzL0Jhc2ljTWF0ZXJpYWxcIik7XHJcbmltcG9ydCBVUkxMb2FkZXJcdFx0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL25ldC9VUkxMb2FkZXJcIik7XHJcbmltcG9ydCBVUkxMb2FkZXJEYXRhRm9ybWF0XHRcdFx0PSByZXF1aXJlKFwiYXdheWpzLWNvcmUvbGliL25ldC9VUkxMb2FkZXJEYXRhRm9ybWF0XCIpO1xyXG5pbXBvcnQgVVJMUmVxdWVzdFx0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvbmV0L1VSTFJlcXVlc3RcIik7XHJcbmltcG9ydCBQYXJzZXJVdGlsc1x0XHRcdFx0XHQ9IHJlcXVpcmUoXCJhd2F5anMtY29yZS9saWIvcGFyc2Vycy9QYXJzZXJVdGlsc1wiKTtcclxuXHJcbmNsYXNzIE1pcE1hcFNvZnR3YXJlVGVzdCB7XHJcblxyXG4gICAgcHJpdmF0ZSB2aWV3OlZpZXc7XHJcbiAgICBwcml2YXRlIHJhZjpSZXF1ZXN0QW5pbWF0aW9uRnJhbWU7XHJcbiAgICBwcml2YXRlIHBuZ0xvYWRlciAgIDogVVJMTG9hZGVyO1xyXG4gICAgcHJpdmF0ZSBpbWFnZTpIVE1MSW1hZ2VFbGVtZW50O1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKCkge1xyXG5cclxuICAgICAgICB2YXIgcG5nVVJMUmVxdWVzdDpVUkxSZXF1ZXN0ID0gbmV3IFVSTFJlcXVlc3QoJ2Fzc2V0cy9kb3RzLnBuZycpO1xyXG5cclxuICAgICAgICB0aGlzLnBuZ0xvYWRlciA9IG5ldyBVUkxMb2FkZXIoKTtcclxuICAgICAgICB0aGlzLnBuZ0xvYWRlci5kYXRhRm9ybWF0ID0gVVJMTG9hZGVyRGF0YUZvcm1hdC5CTE9CO1xyXG4gICAgICAgIHRoaXMucG5nTG9hZGVyLmFkZEV2ZW50TGlzdGVuZXIoRXZlbnQuQ09NUExFVEUsIChldmVudDpFdmVudCkgPT4gdGhpcy5wbmdMb2FkZXJDb21wbGV0ZShldmVudCkpO1xyXG4gICAgICAgIHRoaXMucG5nTG9hZGVyLmxvYWQocG5nVVJMUmVxdWVzdCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBwbmdMb2FkZXJDb21wbGV0ZShldmVudDpFdmVudCkge1xyXG4gICAgICAgIHZhciBpbWFnZUxvYWRlcjpVUkxMb2FkZXIgPSA8VVJMTG9hZGVyPiBldmVudC50YXJnZXQ7XHJcbiAgICAgICAgdGhpcy5pbWFnZSA9IFBhcnNlclV0aWxzLmJsb2JUb0ltYWdlKGltYWdlTG9hZGVyLmRhdGEpO1xyXG4gICAgICAgIHRoaXMuaW1hZ2Uub25sb2FkID0gKGV2ZW50KSA9PiB0aGlzLm9uTG9hZENvbXBsZXRlKGV2ZW50KTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIG9uTG9hZENvbXBsZXRlKGV2ZW50KSB7XHJcbiAgICAgICAgRGVidWcuTE9HX1BJX0VSUk9SUyA9IGZhbHNlO1xyXG4gICAgICAgIERlYnVnLlRIUk9XX0VSUk9SUyA9IGZhbHNlO1xyXG5cclxuICAgICAgICB2YXIgZGVmYXVsdFJlbmRlcmVyOkRlZmF1bHRSZW5kZXJlciA9IG5ldyBEZWZhdWx0UmVuZGVyZXIobnVsbCwgZmFsc2UsIFwiYmFzZWxpbmVcIiwgXCJzb2Z0d2FyZVwiKTtcclxuICAgICAgICBkZWZhdWx0UmVuZGVyZXIuYW50aUFsaWFzID0gMjtcclxuICAgICAgICB0aGlzLnZpZXcgPSBuZXcgVmlldyhkZWZhdWx0UmVuZGVyZXIpO1xyXG4gICAgICAgIC8vdGhpcy52aWV3ID0gbmV3IFZpZXcobmV3IERlZmF1bHRSZW5kZXJlcihudWxsLCBmYWxzZSwgXCJiYXNlbGluZVwiKSk7XHJcbiAgICAgICAgdGhpcy5yYWYgPSBuZXcgUmVxdWVzdEFuaW1hdGlvbkZyYW1lKHRoaXMucmVuZGVyLCB0aGlzKTtcclxuXHJcbiAgICAgICAgdGhpcy52aWV3LmJhY2tncm91bmRDb2xvciA9IDB4MjIyMjIyO1xyXG5cclxuICAgICAgICB3aW5kb3cub25yZXNpemUgPSAoZXZlbnQ6VUlFdmVudCkgPT4gdGhpcy5vblJlc2l6ZShldmVudCk7XHJcblxyXG4gICAgICAgIHRoaXMuaW5pdE1lc2hlcygpO1xyXG4gICAgICAgIHRoaXMucmFmLnN0YXJ0KCk7XHJcbiAgICAgICAgdGhpcy5vblJlc2l6ZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgaW5pdE1lc2hlcygpOnZvaWQge1xyXG4gICAgICAgIC8vdmFyIG1hdGVyaWFsOkJhc2ljTWF0ZXJpYWwgPSBuZXcgQmFzaWNNYXRlcmlhbChEZWZhdWx0TWF0ZXJpYWxNYW5hZ2VyLmdldERlZmF1bHRUZXh0dXJlKCkpO1xyXG4gICAgICAgIHZhciBtYXRlcmlhbDpCYXNpY01hdGVyaWFsID0gbmV3IEJhc2ljTWF0ZXJpYWwoUGFyc2VyVXRpbHMuaW1hZ2VUb0JpdG1hcEltYWdlMkQodGhpcy5pbWFnZSkpO1xyXG4gICAgICAgIG1hdGVyaWFsLnNtb290aCA9IHRydWU7XHJcbiAgICAgICAgbWF0ZXJpYWwucmVwZWF0ID0gdHJ1ZTtcclxuICAgICAgICBtYXRlcmlhbC5taXBtYXAgPSB0cnVlO1xyXG4gICAgICAgIHZhciBwbGFuZTpQcmltaXRpdmVQbGFuZVByZWZhYiA9IG5ldyBQcmltaXRpdmVQbGFuZVByZWZhYigxMDAwLDEwMDAsMTAwMCk7XHJcbiAgICAgICAgLy92YXIgcGxhbmU6UHJpbWl0aXZlQ3ViZVByZWZhYiA9IG5ldyBQcmltaXRpdmVDdWJlUHJlZmFiKCk7XHJcbiAgICAgICAgcGxhbmUubWF0ZXJpYWwgPSBtYXRlcmlhbDtcclxuXHJcbiAgICAgICAgdmFyIG1lc2g6TWVzaCA9IDxNZXNoPnBsYW5lLmdldE5ld09iamVjdCgpO1xyXG4gICAgICAgIG1lc2gueSA9IC0xMDA7XHJcbiAgICAgICAgdGhpcy52aWV3LnNjZW5lLmFkZENoaWxkKG1lc2gpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgYzpudW1iZXIgPSAxMDA7XHJcblxyXG4gICAgcHJpdmF0ZSByZW5kZXIoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuYyA+IDEwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYyA9IDA7XHJcbiAgICAgICAgICAgIHRoaXMudmlldy5yZW5kZXIoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jKys7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIG9uUmVzaXplKGV2ZW50OlVJRXZlbnQgPSBudWxsKSB7XHJcbiAgICAgICAgdGhpcy52aWV3LnkgPSAwO1xyXG4gICAgICAgIHRoaXMudmlldy54ID0gMDtcclxuXHJcbiAgICAgICAgdGhpcy52aWV3LndpZHRoID0gd2luZG93LmlubmVyV2lkdGg7XHJcbiAgICAgICAgdGhpcy52aWV3LmhlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodDtcclxuICAgIH1cclxufSJdLCJzb3VyY2VSb290IjoiLi90ZXN0cyJ9
