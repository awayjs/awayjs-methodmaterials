"use strict";
var Sampler2D_1 = require("awayjs-core/lib/image/Sampler2D");
var URLLoaderEvent_1 = require("awayjs-core/lib/events/URLLoaderEvent");
var RequestAnimationFrame_1 = require("awayjs-core/lib/utils/RequestAnimationFrame");
var Debug_1 = require("awayjs-core/lib/utils/Debug");
var View_1 = require("awayjs-display/lib/View");
var PrimitivePlanePrefab_1 = require("awayjs-display/lib/prefabs/PrimitivePlanePrefab");
var DefaultRenderer_1 = require("awayjs-renderergl/lib/DefaultRenderer");
var BasicMaterial_1 = require("awayjs-display/lib/materials/BasicMaterial");
var URLLoader_1 = require("awayjs-core/lib/net/URLLoader");
var URLLoaderDataFormat_1 = require("awayjs-core/lib/net/URLLoaderDataFormat");
var URLRequest_1 = require("awayjs-core/lib/net/URLRequest");
var ParserUtils_1 = require("awayjs-core/lib/parsers/ParserUtils");
var ElementsType_1 = require("awayjs-display/lib/graphics/ElementsType");
var MipMapSoftwareTest = (function () {
    function MipMapSoftwareTest() {
        var _this = this;
        this.c = 100;
        var pngURLRequest = new URLRequest_1.default('assets/dots.png');
        this.pngLoader = new URLLoader_1.default();
        this.pngLoader.dataFormat = URLLoaderDataFormat_1.default.BLOB;
        this.pngLoader.addEventListener(URLLoaderEvent_1.default.LOAD_COMPLETE, function (event) { return _this.pngLoaderComplete(event); });
        this.pngLoader.load(pngURLRequest);
    }
    MipMapSoftwareTest.prototype.pngLoaderComplete = function (event) {
        var _this = this;
        var imageLoader = event.target;
        this.image = ParserUtils_1.default.blobToImage(imageLoader.data);
        this.image.onload = function (event) { return _this.onLoadComplete(event); };
    };
    MipMapSoftwareTest.prototype.onLoadComplete = function (event) {
        var _this = this;
        Debug_1.default.LOG_PI_ERRORS = false;
        Debug_1.default.THROW_ERRORS = false;
        var defaultRenderer = new DefaultRenderer_1.default(null, false, "baseline", "software");
        defaultRenderer.antiAlias = 2;
        this.view = new View_1.default(defaultRenderer);
        //this.view = new View(new DefaultRenderer(null, false, "baseline"));
        this.raf = new RequestAnimationFrame_1.default(this.render, this);
        this.view.backgroundColor = 0x222222;
        window.onresize = function (event) { return _this.onResize(event); };
        this.initSpritees();
        this.raf.start();
        this.onResize();
    };
    MipMapSoftwareTest.prototype.initSpritees = function () {
        //var material:BasicMaterial = new BasicMaterial(DefaultMaterialManager.getDefaultTexture());
        var material = new BasicMaterial_1.default(ParserUtils_1.default.imageToBitmapImage2D(this.image));
        material.style.sampler = new Sampler2D_1.default(true, true, true);
        var plane = new PrimitivePlanePrefab_1.default(material, ElementsType_1.default.TRIANGLE, 1000, 1000, 1000);
        //var plane:PrimitiveCubePrefab = new PrimitiveCubePrefab();
        plane.material = material;
        var sprite = plane.getNewObject();
        sprite.y = -100;
        this.view.scene.addChild(sprite);
    };
    MipMapSoftwareTest.prototype.render = function () {
        if (this.c > 10) {
            this.c = 0;
            this.view.render();
        }
        this.c++;
    };
    MipMapSoftwareTest.prototype.onResize = function (event) {
        if (event === void 0) { event = null; }
        this.view.y = 0;
        this.view.x = 0;
        this.view.width = window.innerWidth;
        this.view.height = window.innerHeight;
    };
    return MipMapSoftwareTest;
}());

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNvZnR3YXJlL01pcE1hcFNvZnR3YXJlVGVzdC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsMEJBQTBCLGlDQUFpQyxDQUFDLENBQUE7QUFDNUQsK0JBQThCLHVDQUF1QyxDQUFDLENBQUE7QUFDdEUsc0NBQXlDLDZDQUE2QyxDQUFDLENBQUE7QUFDdkYsc0JBQXlDLDZCQUE2QixDQUFDLENBQUE7QUFFdkUscUJBQXlDLHlCQUF5QixDQUFDLENBQUE7QUFFbkUscUNBQXlDLGlEQUFpRCxDQUFDLENBQUE7QUFFM0YsZ0NBQXlDLHVDQUF1QyxDQUFDLENBQUE7QUFFakYsOEJBQXlDLDRDQUE0QyxDQUFDLENBQUE7QUFDdEYsMEJBQTBCLCtCQUErQixDQUFDLENBQUE7QUFDMUQsb0NBQWtDLHlDQUF5QyxDQUFDLENBQUE7QUFDNUUsMkJBQTJCLGdDQUFnQyxDQUFDLENBQUE7QUFDNUQsNEJBQTRCLHFDQUFxQyxDQUFDLENBQUE7QUFDbEUsNkJBQXlDLDBDQUEwQyxDQUFDLENBQUE7QUFFcEY7SUFPSTtRQVBKLGlCQXdFQztRQWpCVyxNQUFDLEdBQVUsR0FBRyxDQUFDO1FBOUNuQixJQUFJLGFBQWEsR0FBYyxJQUFJLG9CQUFVLENBQUMsaUJBQWlCLENBQUMsQ0FBQztRQUVqRSxJQUFJLENBQUMsU0FBUyxHQUFHLElBQUksbUJBQVMsRUFBRSxDQUFDO1FBQ2pDLElBQUksQ0FBQyxTQUFTLENBQUMsVUFBVSxHQUFHLDZCQUFtQixDQUFDLElBQUksQ0FBQztRQUNyRCxJQUFJLENBQUMsU0FBUyxDQUFDLGdCQUFnQixDQUFDLHdCQUFjLENBQUMsYUFBYSxFQUFFLFVBQUMsS0FBb0IsSUFBSyxPQUFBLEtBQUksQ0FBQyxpQkFBaUIsQ0FBQyxLQUFLLENBQUMsRUFBN0IsQ0FBNkIsQ0FBQyxDQUFDO1FBQ3ZILElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxDQUFDO0lBQ3ZDLENBQUM7SUFFTyw4Q0FBaUIsR0FBekIsVUFBMEIs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UUFDcEMsSUFBSSxDQUFDLElBQUksQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFDLFdBQVcsQ0FBQztJQUMxQyxDQUFDO0lBQ0wseUJBQUM7QUFBRCxDQXhFQSxBQXdFQyxJQUFBIiwiZmlsZSI6InNvZnR3YXJlL01pcE1hcFNvZnR3YXJlVGVzdC5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBTYW1wbGVyMkRcdFx0XHRcdFx0ZnJvbSBcImF3YXlqcy1jb3JlL2xpYi9pbWFnZS9TYW1wbGVyMkRcIjtcbmltcG9ydCBVUkxMb2FkZXJFdmVudFx0XHRcdFx0ZnJvbSBcImF3YXlqcy1jb3JlL2xpYi9ldmVudHMvVVJMTG9hZGVyRXZlbnRcIjtcbmltcG9ydCBSZXF1ZXN0QW5pbWF0aW9uRnJhbWUgICAgICAgIGZyb20gXCJhd2F5anMtY29yZS9saWIvdXRpbHMvUmVxdWVzdEFuaW1hdGlvbkZyYW1lXCI7XG5pbXBvcnQgRGVidWcgICAgICAgICAgICAgICAgICAgICAgICBmcm9tIFwiYXdheWpzLWNvcmUvbGliL3V0aWxzL0RlYnVnXCI7XG5cbmltcG9ydCBWaWV3ICAgICAgICAgICAgICAgICAgICAgICAgIGZyb20gXCJhd2F5anMtZGlzcGxheS9saWIvVmlld1wiO1xuaW1wb3J0IFNwcml0ZSAgICAgICAgICAgICAgICAgICAgICAgZnJvbSBcImF3YXlqcy1kaXNwbGF5L2xpYi9kaXNwbGF5L1Nwcml0ZVwiO1xuaW1wb3J0IFByaW1pdGl2ZVBsYW5lUHJlZmFiICAgICAgICAgZnJvbSBcImF3YXlqcy1kaXNwbGF5L2xpYi9wcmVmYWJzL1ByaW1pdGl2ZVBsYW5lUHJlZmFiXCI7XG5cbmltcG9ydCBEZWZhdWx0UmVuZGVyZXIgICAgICAgICAgICAgIGZyb20gXCJhd2F5anMtcmVuZGVyZXJnbC9saWIvRGVmYXVsdFJlbmRlcmVyXCI7XG5cbmltcG9ydCBCYXNpY01hdGVyaWFsICAgICAgICAgICAgICAgIGZyb20gXCJhd2F5anMtZGlzcGxheS9saWIvbWF0ZXJpYWxzL0Jhc2ljTWF0ZXJpYWxcIjtcbmltcG9ydCBVUkxMb2FkZXJcdFx0XHRcdFx0ZnJvbSBcImF3YXlqcy1jb3JlL2xpYi9uZXQvVVJMTG9hZGVyXCI7XG5pbXBvcnQgVVJMTG9hZGVyRGF0YUZvcm1hdFx0XHRcdGZyb20gXCJhd2F5anMtY29yZS9saWIvbmV0L1VSTExvYWRlckRhdGFGb3JtYXRcIjtcbmltcG9ydCBVUkxSZXF1ZXN0XHRcdFx0XHRcdGZyb20gXCJhd2F5anMtY29yZS9saWIvbmV0L1VSTFJlcXVlc3RcIjtcbmltcG9ydCBQYXJzZXJVdGlsc1x0XHRcdFx0XHRmcm9tIFwiYXdheWpzLWNvcmUvbGliL3BhcnNlcnMvUGFyc2VyVXRpbHNcIjtcbmltcG9ydCBFbGVtZW50c1R5cGUgICAgICAgICAgICAgICAgIGZyb20gXCJhd2F5anMtZGlzcGxheS9saWIvZ3JhcGhpY3MvRWxlbWVudHNUeXBlXCI7XG5cbmNsYXNzIE1pcE1hcFNvZnR3YXJlVGVzdCB7XG5cbiAgICBwcml2YXRlIHZpZXc6VmlldztcbiAgICBwcml2YXRlIHJhZjpSZXF1ZXN0QW5pbWF0aW9uRnJhbWU7XG4gICAgcHJpdmF0ZSBwbmdMb2FkZXIgICA6IFVSTExvYWRlcjtcbiAgICBwcml2YXRlIGltYWdlOkhUTUxJbWFnZUVsZW1lbnQ7XG5cbiAgICBjb25zdHJ1Y3RvcigpIHtcblxuICAgICAgICB2YXIgcG5nVVJMUmVxdWVzdDpVUkxSZXF1ZXN0ID0gbmV3IFVSTFJlcXVlc3QoJ2Fzc2V0cy9kb3RzLnBuZycpO1xuXG4gICAgICAgIHRoaXMucG5nTG9hZGVyID0gbmV3IFVSTExvYWRlcigpO1xuICAgICAgICB0aGlzLnBuZ0xvYWRlci5kYXRhRm9ybWF0ID0gVVJMTG9hZGVyRGF0YUZvcm1hdC5CTE9CO1xuICAgICAgICB0aGlzLnBuZ0xvYWRlci5hZGRFdmVudExpc3RlbmVyKFVSTExvYWRlckV2ZW50LkxPQURfQ09NUExFVEUsIChldmVudDpVUkxMb2FkZXJFdmVudCkgPT4gdGhpcy5wbmdMb2FkZXJDb21wbGV0ZShldmVudCkpO1xuICAgICAgICB0aGlzLnBuZ0xvYWRlci5sb2FkKHBuZ1VSTFJlcXVlc3QpO1xuICAgIH1cblxuICAgIHByaXZhdGUgcG5nTG9hZGVyQ29tcGxldGUoZXZlbnQ6VVJMTG9hZGVyRXZlbnQpIHtcbiAgICAgICAgdmFyIGltYWdlTG9hZGVyOlVSTExvYWRlciA9IGV2ZW50LnRhcmdldDtcbiAgICAgICAgdGhpcy5pbWFnZSA9IFBhcnNlclV0aWxzLmJsb2JUb0ltYWdlKGltYWdlTG9hZGVyLmRhdGEpO1xuICAgICAgICB0aGlzLmltYWdlLm9ubG9hZCA9IChldmVudCkgPT4gdGhpcy5vbkxvYWRDb21wbGV0ZShldmVudCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBvbkxvYWRDb21wbGV0ZShldmVudCkge1xuICAgICAgICBEZWJ1Zy5MT0dfUElfRVJST1JTID0gZmFsc2U7XG4gICAgICAgIERlYnVnLlRIUk9XX0VSUk9SUyA9IGZhbHNlO1xuXG4gICAgICAgIHZhciBkZWZhdWx0UmVuZGVyZXI6RGVmYXVsdFJlbmRlcmVyID0gbmV3IERlZmF1bHRSZW5kZXJlcihudWxsLCBmYWxzZSwgXCJiYXNlbGluZVwiLCBcInNvZnR3YXJlXCIpO1xuICAgICAgICBkZWZhdWx0UmVuZGVyZXIuYW50aUFsaWFzID0gMjtcbiAgICAgICAgdGhpcy52aWV3ID0gbmV3IFZpZXcoZGVmYXVsdFJlbmRlcmVyKTtcbiAgICAgICAgLy90aGlzLnZpZXcgPSBuZXcgVmlldyhuZXcgRGVmYXVsdFJlbmRlcmVyKG51bGwsIGZhbHNlLCBcImJhc2VsaW5lXCIpKTtcbiAgICAgICAgdGhpcy5yYWYgPSBuZXcgUmVxdWVzdEFuaW1hdGlvbkZyYW1lKHRoaXMucmVuZGVyLCB0aGlzKTtcblxuICAgICAgICB0aGlzLnZpZXcuYmFja2dyb3VuZENvbG9yID0gMHgyMjIyMjI7XG5cbiAgICAgICAgd2luZG93Lm9ucmVzaXplID0gKGV2ZW50OlVJRXZlbnQpID0+IHRoaXMub25SZXNpemUoZXZlbnQpO1xuXG4gICAgICAgIHRoaXMuaW5pdFNwcml0ZWVzKCk7XG4gICAgICAgIHRoaXMucmFmLnN0YXJ0KCk7XG4gICAgICAgIHRoaXMub25SZXNpemUoKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGluaXRTcHJpdGVlcygpOnZvaWQge1xuICAgICAgICAvL3ZhciBtYXRlcmlhbDpCYXNpY01hdGVyaWFsID0gbmV3IEJhc2ljTWF0ZXJpYWwoRGVmYXVsdE1hdGVyaWFsTWFuYWdlci5nZXREZWZhdWx0VGV4dHVyZSgpKTtcbiAgICAgICAgdmFyIG1hdGVyaWFsOkJhc2ljTWF0ZXJpYWwgPSBuZXcgQmFzaWNNYXRlcmlhbChQYXJzZXJVdGlscy5pbWFnZVRvQml0bWFwSW1hZ2UyRCh0aGlzLmltYWdlKSk7XG4gICAgICAgIG1hdGVyaWFsLnN0eWxlLnNhbXBsZXIgPSBuZXcgU2FtcGxlcjJEKHRydWUsIHRydWUsIHRydWUpO1xuICAgICAgICB2YXIgcGxhbmU6UHJpbWl0aXZlUGxhbmVQcmVmYWIgPSBuZXcgUHJpbWl0aXZlUGxhbmVQcmVmYWIobWF0ZXJpYWwsIEVsZW1lbnRzVHlwZS5UUklBTkdMRSwgMTAwMCwxMDAwLDEwMDApO1xuICAgICAgICAvL3ZhciBwbGFuZTpQcmltaXRpdmVDdWJlUHJlZmFiID0gbmV3IFByaW1pdGl2ZUN1YmVQcmVmYWIoKTtcbiAgICAgICAgcGxhbmUubWF0ZXJpYWwgPSBtYXRlcmlhbDtcblxuICAgICAgICB2YXIgc3ByaXRlOlNwcml0ZSA9IDxTcHJpdGU+cGxhbmUuZ2V0TmV3T2JqZWN0KCk7XG4gICAgICAgIHNwcml0ZS55ID0gLTEwMDtcbiAgICAgICAgdGhpcy52aWV3LnNjZW5lLmFkZENoaWxkKHNwcml0ZSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjOm51bWJlciA9IDEwMDtcblxuICAgIHByaXZhdGUgcmVuZGVyKCkge1xuICAgICAgICBpZiAodGhpcy5jID4gMTApIHtcbiAgICAgICAgICAgIHRoaXMuYyA9IDA7XG4gICAgICAgICAgICB0aGlzLnZpZXcucmVuZGVyKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5jKys7XG4gICAgfVxuXG4gICAgcHVibGljIG9uUmVzaXplKGV2ZW50OlVJRXZlbnQgPSBudWxsKSB7XG4gICAgICAgIHRoaXMudmlldy55ID0gMDtcbiAgICAgICAgdGhpcy52aWV3LnggPSAwO1xuXG4gICAgICAgIHRoaXMudmlldy53aWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoO1xuICAgICAgICB0aGlzLnZpZXcuaGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0O1xuICAgIH1cbn0iXSwic291cmNlUm9vdCI6Ii4vdGVzdHMifQ==
